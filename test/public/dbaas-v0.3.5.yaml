openapi: 3.0.0

info:
  title: dbaas API Docs
  description: Describes how to use dbaas API
  version: 0.3.5

servers:
  - url: http://dbaas.{Region}.{Domain}.com/api/{basePath}
    description: development env
    variables:
      Region:
        default: cn-fuzhou-0
        description: 区域等同于地域，物理隔离
      Domain:
        default: 173ops
      basePath:
        default: v1.0


tags:
  - name: backup
    description: 备份相关的API
  - name: restore
    description: 恢复相关的API
  - name: sqlreview
    description: DBaaS SQL审核

components:
  securitySchemes:
    basicAuth:
      type: http
      scheme: basic
  headers:
    X-Request-ID:
      description: unique request id
      schema:
        type: string
        format: uuid
  parameters:
    pgnum:
      name: pgnum
      in: query
      description: 页码
      schema:
        type: integer
        example: 1
    pgsize:
      name: pgsize
      in: query
      description: 每页记录数
      schema:
        type: integer
        example: 10
    IntidInQuery:
      name: int_id
      in: query
      description: 实例编号
      schema:
        type: string
        format: uuid
    GidInQuery:
      name: group_id
      in: query
      description: 实例组编号
      schema:
        type: string
    UUIDInQuery:
      name: uuid
      in: query
      description: 虚机uuid
      schema:
        type: string
        format: uuid
    IntIDInPath:
      name: int_id
      in: path
      required: true
      description: 实例编号
      schema:
        type: string
        format: uuid
    RewIDInPath:
      name: rewid
      in: path
      required: true
      description: 审核编号
      schema:
        type: string
        format: uuid
    BidInPath:
      name: bid
      in: path
      required: true
      description: 备份文件编号
      schema:
        type: integer
    ExpiresInPath:
      name: expires
      in: path
      required: true
      description: 过期时间
      schema:
        type: integer
  responses:
    Unauthorized:
      description: Unauthorized
      content:
        application/json:
          schema:
            type: object
            description: ''
            properties:
              error:
                type: object
                properties:
                  title:
                    type: string
                    example: AccessDenied
                  msg:
                    type: string
                    example: Could not verify your access

  schemas:
    tagins:
      type: object
      description: 实例标签信息
      properties:
        strotype:
          type: string
          example: "1"
          description: 存储类型
        ip:
          type: string
          example: "172.18.3.130"
          description:  管理段IP
        create_time:
          type: string
          example: "2018-03-13 14:40:07"
        port:
          type: integer
          example: 3306
        style:
          type: string
          example: "1核 1GB"
          description: 规格
        group_id:
          type: string
          example: "kc6nmglb"
        uuid:
          type: string
          example: "1b85284b-d472-45f6-a61c-7b3bf7eb0fa9"
          description: 主机id
        zone:
          type: string
          example: "a"
        dbtype:
          type: string
          example: "mysql"
        maxmemory:
          type: string
          example: "1核 1GB"
          description: 配置
        version:
          type: string
          example: MySQL-5.6
        role:
          type: integer
          example: 3
        ins_usage:
          type: string
          example: liufofu
          description: 备注
        zone_display:
          type: string
          example: "仓科A区"
        status:
          type: integer
          example: 0
        key_value:
          type: string
          example: "tag-ipnwi4az"
          description: 标签值
        strotype_display:
          type: string
          example: "容量盘"
          description: 存储类型
        int_id:
          type: string
          example: "4959f342-73e2-4c88-aabc-664c7b70e988"
        role_display:
          type: string
          example: "单实例"
        name:
          type: string
          example: "手游交易"
        status_display":
          type: string
          example: "正常运行"
        stroage:
          type: string
          example: "50"
    Instance:
      type: object
      description: 实例详情
      properties:
        ok:
          type: boolean
          example: true
          description: >
            请求返回标志
              * 成功 true
              * 失败 false
        RequestId:
          type: string
          format: uuid
          example: ce0335b6-4d94-46f7-a92f-57126756310c
          description: http请求序号
        id:
          type: integer
          example: 1
          description: 自增编号
        uuid:
          type: string
          format: uuid
          example: 4d711a3d-d337-417d-8d43-49f2d6b5c5df
          description: 虚机uuid
        int_id:
          type: string
          format: uuid
          example: 4d711a3d-d337-417d-8d43-49f2d6b5c5df
          description: 实例编号
        group_id:
          type: string
          example: geqykonj
          description: 实例组编号
        zone:
          type: string
          example: a
          description: 可用区
        dbtype:
          type: string
          example: mysql
          description: 数据库类型
        ip:
          type: string
          example: 172.18.1.162
          description: 管理网-IP地址
        port:
          type: integer
          example: 3306
          description: 实例端口
        role:
          type: integer
          example: 3
          description: >
            数据库角色
              * 1 主库
              * 2 从库
              * 3 单实例
              * 4 RS结构
        maxmemory:
          type: string
          example: 1C1G
          description: 实例规格
        version:
          type: string
          example: 5.6
          description: 数据库版本
        backup_flag:
          type: integer
          example: 1
          description: 是否开启备份0关闭1开启
        injection_flag:
          type: integer
          example: 1
          description: 是否开启注入保护0关闭1开启
        slow_flag:
          type: integer
          example: 1
          description: 是否开启慢查询0关闭1开启
        protect:
          type: integer
          example: 1
          description: 是否开启过载保护0关闭1开启
        sleep_prec:
          type: integer
          example: 80
          description: 过载保护百分比
        create_time:
          type: string
          format: date-time
          example: "2018-02-13T02:28:28+00:00"
          description: 创建时间
        down_time:
          type: string
          format: date-time
          example: "2018-02-13T02:28:28+00:00"
          description: 下线时间
        offline_desc:
          type: string
          example: 测试实例下线
          description: 下线说明
        ins_usage:
          type: string
          example: 实例备注
          description: 实例备注
        tags:
          type: array
          items:
            type: string
        status:
          type: integer
          example: 0
          enum: [0, 1, 2, 10, 20, 99, 111]
          description: >
            实例状态
              * 0 正常运行
              * 1 下线状态
              * 2 关闭
              * 10 服务异常
              * 20 关机中
              * 99 初始化
              * 111 脚本执行失败

    InstallTaskBody:
      type: object
      description: 部署实例返回体
      properties:
        disk_task:
          type: string
          format: uuid
          example: 9cedbc7d-695f-4fd2-99f2-cf0316a06900
          description: iaas 创建Disk任务ID
        host_task:
          type: string
          format: uuid
          example: 9cedbc7d-695f-4fd2-99f2-cf0316a06900
          description: iaas 创建vm任务ID
        net_task:
          type: string
          format: uuid
          example: 9cedbc7d-695f-4fd2-99f2-cf0316a06900
          description: iaas 创建Nic任务ID
        flag:
          type: integer
          description: >
            iaas服务申请完成标志
            * 0 - 成功完成
            * 11 - 云主机服务申请失败
            * 21 - 网卡服务申请失败
            * 31 - 云硬盘服务申请失败
          example: 0
        host_uuid:
          type: string
          format: uuid
          example: 9cedbc7d-695f-4fd2-99f2-cf0316a06900
          description: 云主机uuid
        int_id:
          type: string
          format: uuid
          example: 9cedbc7d-695f-4fd2-99f2-cf0316a06900
          description: 实例编号
        host_ip:
          type: string
          description: 云主机管理段IP
          example: 172.18.2.219
        service_ip:
          type: string
          description: 用户段IP
          example: 10.5.200.148
        role:
          $ref: '#/components/schemas/Instance/properties/role'
        message:
          type: string
          example: server deployment, please wait patiently
          description: 服务申请状态描述
    AsyncTaskBody:
      type: object
      description: AsyncTaskBody
      properties:
        msg:
          type: string
          example: \u5220\u9664Binlog\u5907\u4efd\u7b56\u7565
          description: 异步任务名称
        id:
          type: string
          format: uuid
          example: 2cf0337a-acb6-48d9-9849-f3737f97edcd
          description: 异步任务编号


    PageInfo:
      type: object
      description: page info
      properties:
        size:
          type: integer
          example: 10
          description: page size
        page:
          type: integer
          example: 1
          description: current page
        pages:
          type: integer
          example: 10
          description: total page number
        total:
          type: integer
          example: 20
          description: total records number
        next_num:
          type: integer
          example: null
          description: next page number
        prev_num:
          type: integer
          example: null
          description: prev page number
        has_next:
          type: boolean
          example: false
          description: whether has next page
        has_prev:
          type: boolean
          example: false
          description: whether has prev page
    BackupSetting:
      type: object
      description: 备份策略详情
      properties:
        id:
          $ref: '#/components/schemas/Instance/properties/id'
        int_id:
          $ref: '#/components/schemas/Instance/properties/int_id'
        group_id:
          $ref: '#/components/schemas/Instance/properties/group_id'
        dbtype:
          $ref: '#/components/schemas/Instance/properties/dbtype'
        ip:
          $ref: '#/components/schemas/Instance/properties/ip'
        port:
          $ref: '#/components/schemas/Instance/properties/port'
        datacycle:
          type: integer
          example: 7
          description: 数据保留周期
        zone:
          $ref: '#/components/schemas/Instance/properties/zone'
        hosttype:
          type: integer
          example: 1
          description: 主机类型
        mode:
          type: string
          example: mysqldump
          description: 备份模式
        dbname:
          type: string
          example: -A
          description: 数据库名称
        backdir:
          type: string
          example: /data/dbbackup
          description: 备份路径
        starttime:
          type: string
          example: 01:00
          description: 备份策略开始时间
        logbak:
          type: integer
          example: 0
          description: 是否开启日志备份
        logcycle:
          type: integer
          example: 7
          description: 日志文件保留周期
        backcron:
          type: string
          example: '*'
          description: 备份策略
        status:
          type: integer
          example: 0
          description: 备份策略-状态0成功99初始化
        ips:
          type: string
          example: 172.18.1.162,10.59.117.196
          description: 备份策略所涉及的ip信息
        description:
          type: string
          example: finished
          description: 用于存储备份策略设置结果

    BackupRecord:
      type: object
      description: 备份记录详情
      properties:
        id:
          $ref: '#/components/schemas/Instance/properties/id'
        int_id:
          $ref: '#/components/schemas/Instance/properties/int_id'
        group_id:
          $ref: '#/components/schemas/Instance/properties/group_id'
        dbtype:
          $ref: '#/components/schemas/Instance/properties/dbtype'
        zone:
          $ref: '#/components/schemas/Instance/properties/zone'
        started_at:
          type: string
          format: date-time
          example: "2018-02-13T02:28:28+00:00"
          description: 备份开始时间
        ended_at:
          type: string
          format: date-time
          example: "2018-02-13T02:28:28+00:00"
          description: 备份结束时间
        mode:
          type: string
          example: rdb
          description: 备份模式
        dbname:
          type: string
          example: test
          description: 数据库名称
        localpath:
          type: string
          example: /data/dbbackup
          description: 本地备份文件路径
        upload_mode:
          type: string
          example: ftp
          description: 上传方式ftp,nfs
        filemtime:
          type: integer
          example: 1523329618
          description: 备份文件时间戳
        filesize:
          type: integer
          example: 123467
          description: 备份文件大小
        remotepath:
          type: string
          example: /nfs/backup/mysql/xx-yy-zz/aa.tar.gz
          description: 远程备份文件物理地址
        backup_type:
          type: integer
          example: 1
          enum: [1, 2, 3, 4]
          description: >
            备份类型
              * 1 全量备份
              * 2 增量备份
              * 3 单次备份
              * 4 binlog
        status:
          type: integer
          example: 0
          enum: [0, 2, 3, 4, 10, 99]
          description: >
            备份策略-状态
              * 0 成功
              * 2 本地备份失败
              * 3 备份成功
              * 4 上传失败
              * 10 备份中
              * 99 初始化
        md5:
          type: string
          example: ff66bf9b1a1e2e605f5e57c2a2a603e4
          description: 记录备份文件的md5信息
        message:
          type: string
          example: finished
          description: 用于存储备份过程的异常信息

    SQLReviewRecord:
      type: object
      description: SQL审核记录详情
      properties:
        rewid:
          type: string
          example: test
          description: 审核编号
        insid:
          $ref: '#/components/schemas/Instance/properties/int_id'
        dbtype:
          $ref: '#/components/schemas/Instance/properties/dbtype'
        ip:
          $ref: '#/components/schemas/Instance/properties/ip'
        port:
          $ref: '#/components/schemas/Instance/properties/port'
        db:
          type: string
          example: test
          description: 数据库名称
        filename:
          type: string
          example: /sqlreview/20180814.sql
          description: 待审核sql文件路径
        content:
          type: string
          example: create table tb(id int);
          description: 待审核sql内容
        created_at:
          type: string
          format: date-time
          example: "2018-02-13T02:28:28+00:00"
          description: 创建时间
        status:
          type: integer
          example: 0
          description: 审核状态- 0 待审核 1 已审核 2 已执行
    SQLReviewResult:
      type: object
      description: SQL审核结果详情
      properties:
        order_seq:
          type: integer
          example: 1
          description: 序列编号
        rewid:
          $ref: '#/components/schemas/SQLReviewRecord/properties/rewid'
        db:
          $ref: '#/components/schemas/SQLReviewRecord/properties/db'
        errlevel:
          type: integer
          example: 0
          description: 错误返回值,非0为异常
        created_at:
          $ref: '#/components/schemas/SQLReviewRecord/properties/created_at'
        affected_rows:
          type: integer
          example: 0
          description: 错前语句执行时预计影响的行数
        errormessage:
          type: string
          example: None
          description: 错误异常信息
        execute_time:
          type: integer
          example: 0
          description: 前语句执行的耗时时间,单位是秒
        sequence:
          type: string
          example: '0_0_0'
          description: 对应备份的序列号
        sql:
          type: string
          example: use liufofu
          description: 当前检查sql信息
        sqlhash:
          type: string
          example: 
          description: 当前语句的hash值
        stage:
          type: string
          example: CHECKED
          description: 审核进度
        stagestatus:
          type: string
          example: Audit completed
          description: 审核进度状态
        is_rollback:
          type: integer
          example: 0
          description: 是否允许回滚
        rollbacked:
          type: integer
          example: 0
          description: 是否已经回滚
        rollbacked_at:
          type: string
          format: date-time
          example: "2018-02-13T02:28:28+00:00"
          description: 回滚时间
    OtherBody:
      type: object
      description: 其他实例信息
      properties:
        action:
          type: string
          example: check/execute
          description: 操作类型

security:
  - basicAuth: []

paths:
  /server/mysql/{int_id}:
    get:
      tags: [实例详情]
      summary: Get a instance info
      description: 获取实例详情(通用型，可以获取数据库类型MySQL/Redis/MongoDB的数据库实例信息)
      parameters:
        - name: int_id
          in: path
          required: true
          description: 实例ID
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: 实例详情信息
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    description: 成功标志
                    example: True
                  data:
                    type: object
                    properties:
                      config:
                        type: object
                        properties:
                          host_type:
                            type: integer
                            example: 1
                            description: 主机类型
                          host_type_display:
                            type: string
                            example: 虚拟机
                            description: 主机类型说明
                          module:
                            type: integer
                            example: 0
                            description: 部署模式
                          module_display:
                            type: string
                            example: 简单模式
                            description: 部署模式说明
                          stroage:
                            type: string
                            example: 50
                            description: 存储容量
                          strotype:
                            type: integer
                            example: 10
                            description: >
                              存储类型:
                              * 10 - 容量本地
                              * 11 - 容量云盘
                              * 20 - 性能本地
                              * 21 - 性能云盘
                          strotype_display:
                            type: string
                            example: 容量盘
                            description: 存储类型描述
                          style:
                            type: string
                            example: 2U / 4G
                            description: 实例规格名称
                          bw_in:
                            type: integer
                            example: 0
                            description: 网卡带宽入口限速
                          bw_out:
                            type: integer
                            example: 0
                            description: 网卡带宽出口限速
                          flavorRef:
                            type: string
                            example: rds.mysql.medium
                            description: 规格编码
                          io_bytes:
                            type: integer
                            example: 104857600
                            description: IO限速
                          iops:
                            type: integer
                            example: 2000
                            description: IOps
                          max_connections:
                            type: string
                            example: 1200
                            description: 最大连接数

                      info:
                        type: object
                        description: 实例基本信息
                        properties:
                          create_time:
                            type: string
                            example: '2018-03-07 18:00:11'
                            description: 创建时间
                          desc:
                            type: string
                            example: xx创建
                            description: 备注说明
                          int_id:
                            type: string
                            format: uuid
                            example: 04e46a60-8a2d-4d2e-90d7-64bb3df17430
                            description: 实例ID
                          internet_type:
                            type: string
                            example: vsw
                            description: 外网类型
                          ip:
                            type: string
                            example: 172.18.0.3
                            description: 用户管理段IP
                          ips:
                            type: array
                            items:
                              type: object
                              properties:
                                create_time:
                                  type: string
                                  example: 2018-03-02T01:49:40+00:00
                                  description: 创建日期
                                id:
                                  type: integer
                                  example: 1
                                  description: id号
                                int_id:
                                  type: string
                                  format: uuid
                                  example: 04e46a60-8a2d-4d2e-90d7-64bb3df17430
                                  description: 实例ID
                                ip:
                                  type: string
                                  example: 10.59.116.230
                                  description: IP信息
                                nic_uuid:
                                  type: string
                                  example: 9ebee8e9-d970-46fa-94e3-f09557dceb74
                                  description: 网卡UUID
                                subnet:
                                  type: string
                                  example: 10.59.116.0/24
                                  description: 子网信息
                                vpc:
                                  type: string
                                  example: vpc-02c270dc 10.59.0.0/16 仓科内网
                                  description: vpc描述信息
                                vtype:
                                  type: integer
                                  example: 2
                                  description: >
                                    网卡类型:
                                    * 1 - 管理网段ip
                                    * 2 - 用户网段ip
                                    * 3 - 外网ip
                          port:
                            type: integer
                            example: 3306
                            description: 端口
                          role:
                            type: integer
                            example: 1
                            description: >
                              角色类型:
                              * 1 - 主库
                              * 2 - 从库
                              * 3 - 从库
                              * 4 - rs角色（$rsname-primary/SECONDARY)
                          role_display:
                            type: string
                            example: 主库
                            description: 角色类型说明
                          service_ip:
                            type: string
                            example: 10.59.115.230
                            description: 用户IP
                          status:
                            type: integer
                            enum: [0, 1, 2, 10, 99, 111, 20]
                            example: 0
                            description: >
                              实例状态标志:
                              * 0 - 正常运行,
                              * 1 - 下线状态,
                              * 99 - 初始化,
                              * 2 - 关闭,
                              * 10 - 服务异常,
                              * 20 - 正在下线,
                              * 111 - 部署失败
                          status_display:
                            type: string
                            example: 正常运行
                            description: 实例状态说明
                          subnet:
                            type: string
                            example: 10.59.116.0/24
                            description: 用户网段子网
                          uuid:
                            type: string
                            example: 4c8f41d4-3c0e-4e95-96b5-044501c326f7
                            description: 主机uuid
                          version:
                            type: string
                            example: MySQL-5.7
                            description: 数据库版本
                          vpc:
                            type: string
                            example: vpc-02c270dc 10.59.0.0/16 仓科内网
                            description: vpc信息描述
                          zone:
                            type: string
                            example: a
                            description: 可用区
                          zone_display:
                            type: string
                            example: 仓科A区
                            description: 可用区说明
                      group_ins:
                        type: array
                        description: 同组其他实例信息
                        items:
                          type: object
                          properties:
                            create_time:
                              type: string
                              example: 2017-07-04 16:15:05
                              description: 创建日期
                            int_id:
                              type: string
                              example: e6d725a1-1ac2-4bdc-b3c9-87a7b73ac70d
                              description: 实例ID
                            ip:
                              type: string
                              example: 10.59.115.226
                              description: IP信息
                            port:
                              type: integer
                              example: 4333
                              description:  端口信息
                            role:
                              type: integer
                              example: 2
                              description: >
                                角色类型:
                                * 1 - 主库
                                * 2 - 从库
                                * 3 - 从库
                                * 4 - rs角色（$rsname-primary/SECONDARY)
                            role_display:
                              type: string
                              example: 主库
                              description: 角色类型说明
                            status:
                              type: integer
                              enum: [0, 1, 2, 10, 99, 111, 20]
                              example: 0
                              description: >
                                实例状态标志:
                                * 0 - 正常运行,
                                * 1 - 下线状态,
                                * 99 - 初始化,
                                * 2 - 关闭,
                                * 10 - 服务异常,
                                * 20 - 正在下线,
                                * 111 - 部署失败
                            status_display:
                              type: string
                              example: 正常运行
                              description: 实例状态说明
                            stroage:
                              type: string
                              example: 50
                              description: 存储容量
                            strotype:
                              type: integer
                              example: 10
                              description: >
                                存储类型:
                                * 10 - 容量本地
                                * 11 - 容量云盘
                                * 20 - 性能本地
                                * 21 - 性能云盘
                            strotype_display:
                              type: string
                              example: 容量盘
                              description: 存储类型描述
                            style:
                              type: string
                              example: 2U / 4G
                              description: 实例规格名称
                            version:
                              type: string
                              example: MySQL-5.7
                              description: 数据库版本
                            zone:
                              type: string
                              example: a
                              description: 可用区
                            zone_display:
                              type: string
                              example: 仓科A区
                              description: 可用区说明'
                      tag:
                        type: array
                        items:
                          type: object
                          properties:
                            key_value:
                              type: string
                              example: tag-0xv5i68i
                              description: 标签编码
                            name:
                              type: string
                              example: tag
                              description: 标签名字
                            colour:
                              type: string
                              example: #00a65a
                              description: 标签颜色编码
        '202':
          description: No data
  /server/mysql:
    post:
      tags: [MySQL - 实例创建]
      summary: Creates a new mysql instance.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                int_num:
                  type: integer
                  example: 1
                  description: 申请实例组数
                host_type:
                  type: integer
                  example: 1
                  description: >
                    主机类型:
                    * 1-虚拟机
                    * 2-物理机
                dbtype:
                  type: string
                  example: mysql
                  description: >
                    数据库类型:
                    * - mysql
                    * - redis
                    * - mongodb
                master_ip:
                  type: string
                  example: ""
                  description: 主实例IP 默认空。host_type=1,roletype=2必填,host_type=2 必填
                master_port:
                  type: string
                  example: ""
                  description: 主实例PORT，默认空。host_type=1,roletype=2必填,host_type=2 必填
                slave_ip:
                  type: string
                  example: ""
                  description: 从实例ip *  默认空 host_type=2,roletype=1,2 必填
                slave_port:
                  type: string
                  example: ""
                  description: 从实例port * 默认空 host_type=2,roletype=1,2 必填
                roletype:
                  type: integer
                  example: 1
                  description:  >
                    部署类型:
                    * 1 - 主从模式
                    * 2 - 单从模式
                    * 3 - 单实例模式
                zone:
                  type: string
                  example: a
                  description: 可用区
                version:
                  type: string
                  example: 5.7
                  description: >
                    数据库版本:
                    * mysql - 5.6,5.7
                    * redis -  2.8
                    * mongodb - 3.2
                nettype:
                  type: integer
                  example: 1
                  description: >
                    网络类型:
                    * 1 - 专有网络
                    * 2 - 经典网络
                vpc:
                  type: string
                  example: vpc-02c270dc 10.59.0.0/16 仓科内网
                  description: VPC描述说明
                subnet:
                  type: string
                  example: 10.5.217.0/24
                  description: 用户网段
                subnetRef:
                  type: string
                  example: e0e661c6-ab9f-42eb-b320-e660423487cc
                  description: 用户网段UUID
                style:
                  type: string
                  example: ""
                  description: 规格描述说明
                flavorRef:
                  type: string
                  example: rds.mysql.tiny
                  description: 规格编码
                stroage:
                  type: string
                  example: 50
                  description: 硬盘容量
                strotype:
                  type: string
                  example: 11
                  description: >
                    存储类型 :
                    * 10 - 容量本地
                    * 11 - 容量云盘
                    * 20 - 性能本地
                    * 21 - 性能云盘
                user:
                  type: string
                  example: root
                  description: 用户名
                password:
                  type: string
                  example: dfoi3af
                  description: 密码
                backup_flag:
                  type: integer
                  example: 1
                  description: >
                    备份设置标志:
                    * 0 - 不备份
                    * 1 - 备份
                slow_flag:
                  type: integer
                  example: 0
                  description: >
                    慢查询开启标志:
                    * 0 - 关闭
                    * 1 - 开启
                injection_flag:
                  type: integer
                  example: 0
                  description: >
                    注入保护开启标志:
                    * 0 - 关闭
                    * 1 - 开启
                protect:
                  type: integer
                  example: 0
                  description: >
                    过载保护开启标志:
                    * 0 - 关闭
                    * 1 - 开启
                sleep_prec:
                  type: integer
                  example: 80
                  description: 连数百分比 默认80,当protect启动时生效
                parameters:
                  type: array
                  description: 参数配置，针对专家模式 默认为空
                  items:
                    type: object
                tag:
                  type: array
                  description: 标签 默认空
                  items:
                    type: string
                dsc:
                  type: string
                  example: "swagger editor"
                  description: 备注说明
                module:
                  type: integer
                  example: 0
                  description: >
                    部署模式 :
                      * 0 - 简单模式
                      * 1 - 专家模式
      responses:
        '202':
          description: Created
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    description: 成功标志
                    example: True
                  data:
                    type: array
                    items:
                      type: object
                      properties:
                        disk_task:
                          type: string
                          description: iaas 创建硬盘任务ID
                          example: 3cabf143-5096-481f-9cf9-cc741c23166d
                        flag:
                          type: integer
                          description: >
                            iaas服务申请完成标志
                            * 0 - 成功完成
                            * 11 - 云主机服务申请失败
                            * 21 - 网卡服务申请失败
                            * 31 - 云硬盘服务申请失败
                          example: 0
                        host_ip:
                          type: string
                          description: 云主机管理段IP
                          example: 172.18.2.219
                        host_task:
                          type: string
                          description: iaas 创建云主机任务ID
                          example: 53cf14f6-7b71-44e8-b315-bce12a415371
                        host_uuid:
                          type: string
                          description: 云主机uuid
                          example: cc2c0625-2ae1-41fc-b87d-80b495571962
                        int_id:
                          type: string
                          description: db实例ID
                          example: bf7168b6-8b98-4dda-89e6-98db74fff339
                        message:
                          type: string
                          description: 服务申请状态描述
                          example: server deployment, please wait patiently
                        net_task:
                          type: string
                          description: iaas 创建网卡任务ID
                          example: cbf9b357-01ae-4508-9b58-144a621b6491
                        role:
                          type: integer
                          example: 2
                          description: >
                            角色类型:
                            * 1 - 主库
                            * 2 - 从库
                            * 3 - 从库
                            * 4 - rs角色
                        service_ip:
                          type: string
                          description: 用户段IP
                          example: 10.5.216.164
                  group_id:
                    type: string
                    example: 8vi356hj
                    description: 组ID
  /ops/mysql/{int_id}:
    post:
      tags: [MySQL - 实例操作]
      summary: start、stop、reboot、offline instance
      description: 对实例进行启动，关闭，重启，下线操作
      parameters:
        - name: int_id
          in: path
          required: true
          description: 实例ID
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                ops_type:
                  type: integer
                  example: 1
                  description: >
                    操作类型:
                    * 1 - 启动
                    * 2 - 关闭
                    * 3 - 重启
                    * 4 - 下线
      responses:
        '202':
          description: Created
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    description: 成功标志
                    example: True
                  task:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: string
                          description: 任务ID
                          example: 3cabf143-5096-481f-9cf9-cc741c23166d
                        msg:
                          type: string
                          example: 实例启动
                          description: >
                            任务说明：
                            * 实例启动
                            * 实例关闭
                            * 实例重启
                            * 实例删除
  /conf/mysql/{int_id}:
    get:
      tags: [MySQL - 参数配置]
      summary: Get  databases parameters info from localhost
      description: 获取MySQL参数配置信息
      parameters:
        - name: int_id
          in: path
          required: true
          description: 实例ID
          schema:
            type: string
            format: uuid
      responses:
        '202':
          description: 请求返回
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    description: 成功标志
                    example: True
                  task:
                    type: array
                    description: 任务描述
                    items:
                      type: object
                      properties:
                        id:
                          type: string
                          description: 任务ID
                          example: 4013a014-018c-44bd-848f-edda43d0409b
                        msg:
                          type: string
                          description: 任务描述
                          example: 实例参数获取



    post:
      tags: [MySQL - 参数配置]
      summary: mysql config parameter
      description: 参数配置
      parameters:
        - name: int_id
          in: path
          required: true
          description: 实例ID
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                data:
                  type: array
                  description: 同get方法返回参数
                  items:
                    type: object
                    description: 同get方法返回参数,可传递多个
                    properties:
                      max_connections:
                        type: integer
                        example: 300

      responses:
        '202':
          description: 请求返回
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    description: 成功标志
                    example: True
                  task:
                    type: array
                    description: 任务描述
                    items:
                      type: object
                      properties:
                        id:
                          type: string
                          description: 任务ID
                          example: 4013a014-018c-44bd-848f-edda43d0409b
                        msg:
                          type: string
                          description: 任务描述
                          example: 实例参数配置
  /newdb/{int_id}:
    get:
      tags: [MySQL - 数据库管理]
      summary: Get  databases info from webserverdatabase
      description: 获取数据库列表
      parameters:
        - name: int_id
          in: path
          required: true
          description: 实例ID
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: 实例详情信息
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    description: 成功标志
                    example: True
                  data:
                    type: array
                    items:
                      type: object
                      properties:
                        int_id:
                          type: string
                          example: 40c638cc-bc29-4245-bfa8-895966cd030b
                          description: 实例ID
                        dbname:
                          type: string
                          example: icloud
                          description: 数据库名
                        charset:
                          type: string
                          example: utf8
                          description: 数据库字符集
                        id:
                          type: integer
                          example: 1
    post:
      tags: [MySQL - 数据库管理]
      summary: create a database for mysql
      description: 创建数据库
      parameters:
        - name: int_id
          in: path
          required: true
          description: 实例ID
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                dbname:
                  type: string
                  example: icloud
                  description: 数据库名
                charset:
                  type: string
                  example: utf8
                  description: 字符集
      responses:
        '202':
          description: Created
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    description: 成功标志
                    example: True
                  task:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: string
                          description: 任务ID
                          example: 3cabf143-5096-481f-9cf9-cc741c23166d
                        msg:
                          type: string
                          example: 创建数据库
                          description: 任务说明
  /dbname/{int_id}:
    put:
      tags: [MySQL - 数据库管理]
      summary: get a database info from localhostserver
      description: 从远端数据库获取最新数据库信息
      parameters:
        - name: int_id
          in: path
          required: true
          description: 实例ID
          schema:
            type: string
            format: uuid
      responses:
        '202':
          description: Created
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    description: 成功标志
                    example: True
                  task:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: string
                          description: 任务ID
                          example: 3cabf143-5096-481f-9cf9-cc741c23166d
                        msg:
                          type: string
                          example: 获取数据库信息
                          description: 任务说明
  /dropname/{int_id}:
    post:
      tags: [MySQL - 数据库管理]
      summary: drop a database for mysql
      description: 删除数据库
      parameters:
        - name: int_id
          in: path
          required: true
          description: 实例ID
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                dbinfo:
                  type: array
                  example: ["icloud","blade"]
                  description: 数据库名
                  items:
                    type: string

      responses:
        '202':
          description: Created
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    description: 成功标志
                    example: True
                  task:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: string
                          description: 任务ID
                          example: 3cabf143-5096-481f-9cf9-cc741c23166d
                        msg:
                          type: string
                          example: 删除数据库信息
                          description: 任务说明
  /dbpriv/{int_id}:
    get:
      tags: [MySQL - 权限管理]
      summary: Get  databases parameters info from localhost
      description: 异步-获取MySQL实例的权限列表
      parameters:
        - name: int_id
          in: path
          required: true
          description: 实例ID
          schema:
            type: string
            format: uuid
      responses:
        '202':
          description: 请求返回
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    description: 成功标志
                    example: True
                  task:
                    type: array
                    description: 任务描述
                    items:
                      type: object
                      properties:
                        id:
                          type: string
                          description: 任务ID
                          example: 4013a014-018c-44bd-848f-edda43d0409b
                        msg:
                          type: string
                          description: 任务描述
                          example: 实例参数获取

    post:
      tags: [MySQL - 权限管理]
      summary: mysql ops privileges
      description: MySQL权限操作
      parameters:
        - name: int_id
          in: path
          required: true
          description: 实例ID
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                pri_type:
                  type: string
                  example: grant
                  description: >
                    权限操作类型:
                    * grant -  权限授予（密码修改）
                    * get -    权限获取
                    * revoke - 权限回收
                    * copy - 权限复制
                    * drop -  权限删除
                pri:
                  type: string
                  example: SELECT, INSERT, UPDATE, DELETE,DROP, CREATE, REFERENCES, INDEX, CREATE TEMPORARY TABLES, LOCK TABLES, EXECUTE, CREATE VIEW, SHOW VIEW, EVENT
                  description: 权限信息, 密码修改时 传递:USAGE 同时：pri_type=grant
                dbname:
                  type: string
                  example: icloud
                  description: 数据库名字
                ip:
                  type: string
                  example: 10.59.117.%
                  description: 授权IP段 或者需要授权的具体IP
                table_name:
                  type: string
                  example: "*"
                  description: 表名，全部表用 * 默认为*
                user:
                  type: string
                  example: blade
                  description: 用户名
                passwd:
                  type: string
                  example: blade
                  description: 密码
                copyip:
                  type: string
                  example: 172.18.1.32
                  description: 被复制权限的IP pri_type=copy时必填


      responses:
        '202':
          description: 请求返回
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    description: 成功标志
                    example: True
                  task:
                    type: array
                    description: 任务描述
                    items:
                      type: object
                      properties:
                        id:
                          type: string
                          description: 任务ID
                          example: 4013a014-018c-44bd-848f-edda43d0409b
                        msg:
                          type: string
                          description: >
                             任务描述:
                             * 权限授予
                             * 权限获取
                             * 权限回收
                             * 权限复制
                             * 权限删除

                          example: 权限授予
  /getpriv/{int_id}:
    get:
      tags: [MySQL - 权限管理]
      summary: Get  privileges for user host info
      description: 获取MySQL实例的用户和host信息
      parameters:
        - name: int_id
          in: path
          required: true
          description: 实例ID
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: 请求返回
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    description: 成功标志
                    example: True
                  data:
                    type: array
                    description: 权限列表信息
                    items:
                      type: object
                      properties:
                        host:
                          type: string
                          description: 授权用户IP信息或者段信息
                          example: 10.59.117.%
                        user:
                          type: string
                          description: 授权用户名
                          example: blade



    post:
      tags: [MySQL - 权限管理]
      summary: mysql user privileges info
      description: MySQL用户权限详情
      parameters:
        - name: int_id
          in: path
          required: true
          description: 实例ID
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              description:  传入get方法获取的信息
              properties:
                host:
                  type: string
                  example: 10.59.117.%
                  description: 用户IP信息
                user:
                  type: string
                  example: blade
                  description: 用户名

      responses:
        '200':
          description: 请求返回
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    description: 成功标志
                    example: True
                  data:
                    type: array
                    description: 任务描述
                    items:
                      type: object
                      properties:
                        host:
                          type: string
                          description: 用户IP信息
                          example: 10.59.117.%
                        tblname:
                          type: string
                          description: 表信息
                          example: icloud.*
                        user:
                          type: string
                          description: 用户名
                          example: blade
  /dbsecure/{int_id}:
    post:
      tags: [MySQL -安全管理]
      summary: MySQL config secure
      description: MySQL 慢查询、响应时长过载保护、注入保护设置、连接数过载保护设置
      parameters:
        - name: int_id
          in: path
          required: true
          description: 实例ID
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                opstype:
                  type: string
                  example: slowlog
                  description: >
                    安全设置操作类型:
                    * slowlog - 慢查询
                    * injection -  注入保护
                    * protect - 响应时长过载保护
                    * sleep_prec - 连接数过载保护设置
                opsflag:
                  type: integer
                  example: 1
                  description: >
                    开关设置:
                    * 0 - 关闭 （所有类型）
                    * 1 - 开通 （slowlog ，injection)
                    * 300 - opstype=protect 响应时长大于x秒
                    *  80 - 百分比 opstype=sleep_prec  连接数大于最大连接数百分比


      responses:
        '202':
          description: 请求返回
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    description: 成功标志
                    example: True
                  task:
                    type: array
                    description: 任务描述
                    items:
                      type: object
                      properties:
                        id:
                          type: string
                          description: 任务ID
                          example: 4013a014-018c-44bd-848f-edda43d0409b
                        msg:
                          type: string
                          description: 任务描述
                          example: SQL注入设置/响应时长过载保护设置/慢查询设置/连接数过载保护设置
  /safeinfo/{int_id}/safe/{safe}:
    get:
      tags: [MySQL -安全管理]
      summary: MySQL query secure
      description: 查询MySQL安全配置信息
      parameters:
        - name: int_id
          in: path
          required: true
          description: 实例ID
          schema:
            type: string
            format: uuid
        - name: safe
          in: path
          required: true
          description: >
            安全设置类型：
              * slowlog - 慢查询
              * injection -  注入保护
              * protect - 响应时长过载保护
              * sleep_prec - 连接数过载保护设置
          schema:
            type: string
            example: slowlog
      responses:
        '200':
          description: 请求返回
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    description: 成功标志
                    example: True
                  data:
                    type: array
                    description: 安全服务信息
                    items:
                      type: object
                      properties:
                        int_id:
                          type: string
                          description: 实例ID
                        ip:
                          type: string
                          description: ip信息
                        opsflag:
                          type: integer
                          description:  >
                            服务状态:
                            * 0 - 关闭 （所有类型）
                            * 1 - 开通 （slowlog ，injection)
                            * 300 - opstype=protect 响应时长大于x秒
                            *  80 - 百分比 opstype=sleep_prec  连接数大于最大连接数百分比
                            *  99 - 初始化
                            * 111 - 设置失败
                          example: 1
                        opsflag_display:
                          type: string
                          description: 状态说明
                          example: 开通
                        opstype:
                          type: string
                          example: slowlog
                          description: >
                            安全设置类型：
                              * slowlog - 慢查询
                              * injection -  注入保护
                              * protect - 响应时长过载保护
                              * sleep_prec - 连接数过载保护设置
                        opstype_display:
                          type: string
                          description: 说明
                          example: 慢查询
                        port:
                          type: integer
                          example: 3306
  /slowdetail/{int_id}:
    post:
      tags: [MySQL - 慢查询]
      summary: MySQL slowlogdetail
      description: 按时间段查询MySQL慢查询信息
      parameters:
        - name: int_id
          in: path
          required: true
          description: 实例ID
          schema:
            type: string
            format: uuid

      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                starttime:
                  type: string
                  example: '2018-03-27 11:07:20'
                  description: 开始时间
                opsflag:
                  type: string
                  example: '2018-04-04 11:07:20'
                  description: 结束时间
      responses:
        '200':
          description: 请求返回
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    description: 成功标志
                    example: True
                  data:
                    type: array
                    description: 慢查询详情
                    items:
                      type: object
                      properties:
                        int_id:
                          type: string
                          description: 实例ID
                          example: 9a9fe824-f4b8-11e6-b21d-e41f1344648a
                        checksum:
                          type: string
                          description: SQL语句ID
                          example: 9A80B6593EA7900B
                        dbname:
                          type: string
                          description: 数据库名
                          example: icloud
                        fingerprint:
                          type: string
                          description: 格式化的SQL语句
                          example:  select * from pre_forum_post_? where tid=? and `invisible`=? order by dateline desc limit ?
                        sample:
                          type: string
                          description: SQL范例
                          example: SELECT * FROM pre_forum_post_43 WHERE tid=7831843 AND `invisible`='0' ORDER BY dateline DESC  LIMIT 19661, 20
                        ts_cnt:
                          type: integer
                          description: 当前时间内扫描出现的次数
                          example: 1207
                        ts_max:
                          type: string
                          description: 扫描时间内最后出现的时间
                          example: '2018-04-03 10:50:35'
                        ts_min:
                          type: string
                          description: 扫描时间内开始出现的时间
                          example: '2018-03-27 18:15:19'
                        Rows_send_max:
                          type: integer
                          description: 返回最长行数
                          example: 20
                        Rows_send_sum:
                          type: integer
                          description: 返回总行数
                          example: 24140
                        Rows_examined_max:
                          type: integer
                          description: 解析最大行数
                          example: 542743
                        Rows_examined_sum:
                          type: integer
                          description: 解析总行数
                          example: 414861902
                        Lock_time_max:
                          type: integer
                          description: 锁定最长时长
                          example: 0.00153
                        lock_time_sum:
                          type: integer
                          description: 锁定总时长
                          example: 0.08370511
                        Query_time_max:
                          type: integer
                          description: 执行最长时长
                          example: 12.1796
                        Query_time_min:
                          type: integer
                          description: 执行最小时长
                          example: 1.00151
                        Query_time_sum:
                          type: integer
                          description: 执行总时长
                          example: 1863
  /manager/sample/{int_id}:
    post:
      tags: [MySQL - 采样分析]
      summary: MySQL sampling info  ops
      description: MySQL采样分析记录查询和删除
      parameters:
        - name: int_id
          in: path
          required: true
          description: 实例ID
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                ops_type:
                  type: integer
                  example: 1
                  description: >
                    采样记录操作：
                    * 1 - 查询记录
                    * 2 - 删除记录
                task_id:
                  type: string
                  example: 5fe41b72-9f78-4036-8421-2a63b05855e0
                  description: 采样分析任务ID 通过通用型采样分析记录查询接口获得
      responses:
        '200':
          description: ops_type=1 请求返回
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    description: 成功标志
                    example: True
                  data:
                    type: array
                    description: 采样记录详情
                    items:
                      type: object
                      properties:
                        id:
                          type: integer
                          description: 行号
                          example: 4013a014-018c-44bd-848f-edda43d0409b
                        int_id:
                          type: string
                          description: 实例ID
                          example: 9a9fe824-f4b8-11e6-b21d-e41f1344648a
                        host:
                          type: string
                          description: 远程访问客户端IP
                          example: 10.59.113.215
                        ip:
                          type: string
                          description: 实例IP
                          example: 172.18.30.236
                        port:
                          type: integer
                          description: 端口
                          example: 3306
                        task_id:
                          type: string
                          description: 采样任务ID
                          example: 5fe41b72-9f78-4036-8421-2a63b05855e0
                        checksum:
                          type: string
                          description: SQL语句ID
                          example: 9A80B6593EA7900B
                        dbs:
                          type: string
                          description: 数据库名
                          example: icloud
                        distillate:
                          type: string
                          description: XX
                          example: SELECT pdb_gamelib_rel
                        fingerprint:
                          type: string
                          description: 格式化的SQL语句
                          example:  select * from `pdb_gamelib_rel` `t` where `t`.`game_id`=?
                        sample:
                          type: string
                          description: SQL范例
                          example: ELECT * FROM `pdb_gamelib_rel` `t` WHERE `t`.`game_id`=10009966
                        ts_cnt:
                          type: integer
                          description: 当前时间内扫描出现的次数
                          example: 1207
                        ts_max:
                          type: string
                          description: 扫描时间内最后出现的时间
                          example: '2018-03-22T13:53:51+00:00'
                        ts_min:
                          type: string
                          description: 扫描时间内开始出现的时间
                          example: '2018-03-22T13:53:51+00:00'
                        analyze_time:
                          type: string
                          description: 分析时间
                          example: '2018-03-22T13:53:52+00:00'
                        Warning_count_sum:
                          type: integer
                          description: 告警总数
                          example: 0.0
                        Warning_count_stddev:
                          type: integer
                          description: 标准方差告警数
                          example: 0.0
                        Warning_count_pct_95:
                          type: integer
                          description: 95%的告警数
                          example: 0.0
                        Warning_count_min:
                          type: integer
                          description: 最小告警数
                          example: 0.0
                        Warning_count_median:
                          type: integer
                          description: 平均告警数
                          example: 0.0
                        Warning_count_max:
                          type: integer
                          description: 最大告警数
                          example: 0.0
                        Query_time_max:
                          type: integer
                          description: 最大请求时长
                          example: 0.008817
                        Query_time_median:
                          type: integer
                          description: 请求时长平均数
                          example: 0.000568
                        Query_time_min:
                          type: integer
                          description: 最小请求时长
                          example: 0.000107
                        Query_time_pct_95:
                          type: integer
                          description: 95% 请求时长
                          example: 0.00563
                        Query_time_stddev:
                          type: integer
                          description: 请求时长标准方差数
                          example: 0.002193
                        Query_time_sum:
                          type: integer
                          description: 请求总时长
                          example: 0.399999
                        No_good_index_used:
                          type: integer
                          description: 有效索引使用
                          example: 0.0
                        No_index_used:
                          type: integer
                          description: 无使用索引
                          example: 0.0
                        Bytes_sum:
                          type: integer
                          description: 总请求字节数
                          example: 14399.0
                        Bytes_stddev:
                          type: integer
                          description: 请求标准方差数
                          example: 0.0
                        Bytes_pct_95:
                          type: integer
                          description: 请求95%字节数
                          example: 77.0
                        Bytes_min:
                          type: integer
                          description: 请求最小字节数
                          example: 77.0
                        Bytes_median:
                          type: integer
                          description: 请求平均字节数
                          example: 77.0
                        Bytes_max:
                          type: integer
                          description: 请求最大字节数
                          example: 77.0
        '204':
          description: ops_type=2  请求返回
          content:
            application/json:
              schema:
                type: object
                description: ops_type=2 时 操作返回
  /monitor/mysql/{int_id}:
    post:
      tags: [MySQL - 采样分析]
      summary: MySQL sampling
      description: 执行MySQL采样分析
      parameters:
        - name: int_id
          in: path
          required: true
          description: 实例ID
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                count:
                  type: integer
                  example: 1000
                  description: 采样数据包

      responses:
        '202':
          description: 请求返回
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    description: 成功标志
                    example: True
                  task:
                    type: array
                    description: 任务描述
                    items:
                      type: object
                      properties:
                        id:
                          type: string
                          description: 任务ID
                          example: 4013a014-018c-44bd-848f-edda43d0409b
                        msg:
                          type: string
                          description: 任务描述
                          example:  mysql采样
  /showslave/{int_id}:
    get:
      tags: [MySQL - 从库相关]
      summary: query Mysql show slave status from webserver database
      description: 获取MySQL从库状态
      parameters:
        - name: int_id
          in: path
          required: true
          description: 实例ID
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: 请求返回
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    description: 成功标志
                    example: True
                  data:
                    type: array
                    description: 状态返回
                    items:
                      type: object
                      properties:
                        id:
                          type: integer
                          description: 行号
                          example: 531
                        int_id:
                          type: string
                          description: 实例ID
                          example:  bbda19e3-7a09-4243-9206-bf8d4e0585fa
                        Seconds_Behind_Mastert:
                          type: integer
                          description: 主从延迟时间单位秒
                          example: 0
                        Slave_IO_Running:
                          type: string
                          description: io
                          example: Yes
                        Slave_SQL_Running:
                          type: string
                          description: SQL
                          example: Yes
    put:
      tags: [MySQL - 从库相关]
      summary: get Mysql show slave status from  localhost database
      description: 异步-从远端获取MySQL从库状态
      parameters:
        - name: int_id
          in: path
          required: true
          description: 实例ID
          schema:
            type: string
            format: uuid
      responses:
        '202':
          description: 请求返回
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    description: 成功标志
                    example: True
                  task:
                    type: array
                    description: 任务描述
                    items:
                      type: object
                      properties:
                        id:
                          type: string
                          description: 任务ID
                          example: 4013a014-018c-44bd-848f-edda43d0409b
                        msg:
                          type: string
                          description: 任务描述
                          example:  获取slavestatus
  /failover/mysql/{int_id}:
    put:
      tags: [MySQL - 从库相关]
      summary: mysql failover
      description: MySQL从库切换成主库
      parameters:
        - name: int_id
          in: path
          required: true
          description: 实例ID
          schema:
            type: string
            format: uuid
      responses:
        '202':
          description: 请求返回
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    description: 成功标志
                    example: True
                  task:
                    type: array
                    description: 任务描述
                    items:
                      type: object
                      properties:
                        id:
                          type: string
                          description: 任务ID
                          example: 4013a014-018c-44bd-848f-edda43d0409b
                        msg:
                          type: string
                          description: 任务描述
                          example:  主从切换操作
  /phpadmin/{int_id}:
    post:
      tags: [phpAdmin]
      summary:  open/close phpadmin
      description: phpadmin管理 - 开启/关闭
      parameters:
        - name: int_id
          in: path
          required: true
          description: 实例ID
          example: 612252e2-de48-4d59-8721-dfe112fdaeaa
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                ops:
                  type: integer
                  example: 1
                  description: >
                        操作类型：
                        * 0 开启
                        * 1 关闭

      responses:
        '200':
          description: 请求成功返回
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    description: 成功标志
                    example: True
                  task:
                    type: array
                    description: 任务描述
                    items:
                      type: object
                      properties:
                        id:
                          type: string
                          description: 任务ID
                          example: 4013a014-018c-44bd-848f-edda43d0409b
                        msg:
                          type: string
                          description: 任务描述
                          example: 启动phpadmin/关闭phpadmin
    get:
      tags: [phpAdmin]
      summary:   phpadmin status
      description: 查询phpadmin开启状态
      parameters:
        - name: int_id
          in: path
          required: true
          description: 实例ID
          example: 612252e2-de48-4d59-8721-dfe112fdaeaa
          schema:
            type: string
      responses:
        '200':
          description: 请求成功返回
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    description: 成功标志
                    example: True
                  data:
                    type: array
                    description: 数据返回
                    items:
                      type: object
                      properties:
                        id:
                          type: integer
                          description: 行ID
                          example:
                        int_id:
                          type: string
                          description: 实例ID
                          example: 4013a014-018c-44bd-848f-edda43d0409b
                        status:
                          type: integer
                          description: 状态,99初始化，0开启，1关闭
                          example: 0
  /fixgtid/{int_id}:
    get:
      tags: [GTID相关]
      summary:  gtid status
      description: 查询GTID状态
      parameters:
        - name: int_id
          in: path
          required: true
          description: 实例ID
          example: 612252e2-de48-4d59-8721-dfe112fdaeaa
          schema:
            type: string
      responses:
        '200':
          description: 请求成功返回
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    description: 成功标志
                    example: True
                  message:
                    type: string
                    description: 信息描述
                    example: get gitd status success
                  flag:
                    type: integer
                    description: >
                            状态说明
                            * 0 gtid 启动
                            * 1 gtid 关闭
                    example: 0
  /gtidfailover/{int_id}:
    put:
      tags: [GTID相关]
      summary:  gtid mode failover
      description: GTID主从切换
      parameters:
        - name: int_id
          in: path
          required: true
          description: 实例ID
          example: 612252e2-de48-4d59-8721-dfe112fdaeaa
          schema:
            type: string
      responses:
        '200':
          description: 请求成功返回
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    description: 成功标志
                    example: True
                  task:
                    type: array
                    description: 任务描述
                    items:
                      type: object
                      properties:
                        id:
                          type: string
                          description: 任务ID
                          example: 4013a014-018c-44bd-848f-edda43d0409b
                        msg:
                          type: string
                          description: 任务描述
                          example: 切换成主库操作
                        order:
                          type: integer
                          description:  操作步骤
                          example: 1
    get:
      tags: [failover日志查询]
      summary:   failover log
      description: failoverlog
      parameters:
        - name: int_id
          in: path
          required: true
          description: 实例ID
          example: 612252e2-de48-4d59-8721-dfe112fdaeaa
          schema:
            type: string
      responses:
        '200':
          description: 请求成功返回
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    description: 成功标志
                    example: True
                  data:
                    type: array
                    description: 数据返回
                    items:
                      type: object
                      properties:
                        id:
                          type: integer
                          description: 行ID
                          example:
                        int_id:
                          type: string
                          description: 实例ID
                          example: 4013a014-018c-44bd-848f-edda43d0409b
                        opstype:
                          type: string
                          description: 操作类型, setread（设置只读），setmaster（设置成主库），changemaster （从库同步）
                          example: setread
                        status:
                          type: integer
                          description: 状态说明  99初始化，0，成功 111 失败
                          example: 0
                        start_time:
                          type: string
                          description: 开始时间
                          example: "2018-06-08:10:20:20"
                        task_id:
                          type: string
                          description: 任务iD
                          example: 60d3aa14-c10c-a4bd-848f-edda43d0409d
                        uid:
                          type: integer
                          description: 用户ID
                          example: 1
  /server/redis:
    post:
      tags: [Redis - 实例创建]
      summary: Creates a new redis instance.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                int_num:
                  type: integer
                  example: 1
                  description: 申请实例组数
                host_type:
                  type: integer
                  example: 1
                  description: >
                    主机类型:
                    * 1-虚拟机
                    * 2-物理机
                dbtype:
                  type: string
                  example: redis
                  description: >
                    数据库类型:
                    * - mysql
                    * - redis
                    * - mongodb
                master_ip:
                  type: string
                  example: ""
                  description: 主实例IP 默认空。host_type=1,roletype=2必填,host_type=2 必填
                master_port:
                  type: string
                  example: ""
                  description: 主实例PORT，默认空。host_type=1,roletype=2必填,host_type=2 必填
                slave_ip:
                  type: string
                  example: ""
                  description: 从实例ip *  默认空 host_type=2,roletype=1,2 必填
                slave_port:
                  type: string
                  example: ""
                  description: 从实例port * 默认空 host_type=2,roletype=1,2 必填
                roletype:
                  type: integer
                  example: 1
                  description:  >
                    部署类型:
                    * 1 - 主从模式
                    * 2 - 单从模式
                    * 3 - 单实例模式
                zone:
                  type: string
                  example: a
                  description: 可用区
                version:
                  type: string
                  example: 2.8
                  description: >
                    数据库版本:
                    * mysql - 5.6,5.7
                    * redis -  2.8
                    * mongodb - 3.2
                nettype:
                  type: integer
                  example: 1
                  description: >
                    网络类型:
                    * 1 - 专有网络
                    * 2 - 经典网络
                vpc:
                  type: string
                  example: vpc-02c270dc 10.59.0.0/16 仓科内网
                  description: VPC描述说明
                subnet:
                  type: string
                  example: 10.5.217.0/24
                  description: 用户网段
                subnetRef:
                  type: string
                  example: e0e661c6-ab9f-42eb-b320-e660423487cc
                  description: 用户网段UUID
                style:
                  type: string
                  example: ""
                  description: 规格描述说明
                flavorRef:
                  type: string
                  example: rds.redis.small
                  description: 规格编码
                stroage:
                  type: string
                  example: 50
                  description: 硬盘容量
                strotype:
                  type: string
                  example: 11
                  description: >
                    存储类型 :
                    * 10 - 容量本地
                    * 11 - 容量云盘
                    * 20 - 性能本地
                    * 21 - 性能云盘
                user:
                  type: string
                  example: root
                  description: 用户名
                password:
                  type: string
                  example: dfoi3af
                  description: 密码
                backup_flag:
                  type: integer
                  example: 1
                  description: >
                    备份设置标志:
                    * 0 - 不备份
                    * 1 - 备份
                slow_flag:
                  type: integer
                  example: 0
                  description: >
                    慢查询开启标志:
                    * 0 - 关闭
                    * 1 - 开启
                injection_flag:
                  type: integer
                  example: 0
                  description: >
                    注入保护开启标志:
                    * 0 - 关闭
                    * 1 - 开启
                protect:
                  type: integer
                  example: 0
                  description: >
                    过载保护开启标志:
                    * 0 - 关闭
                    * 1 - 开启
                sleep_prec:
                  type: integer
                  example: 80
                  description: 连数百分比 默认80,当protect启动时生效
                parameters:
                  type: array
                  description: 参数配置，针对专家模式 默认为空
                  items:
                    type: object
                tag:
                  type: array
                  description: 标签 默认空
                  items:
                    type: string
                dsc:
                  type: string
                  example: "swagger editor"
                  description: 备注说明
                module:
                  type: integer
                  example: 0
                  description: >
                    部署模式 :
                      * 0 - 简单模式
                      * 1 - 专家模式
      responses:
        '202':
          description: Created
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    description: 成功标志
                    example: True
                  data:
                    type: array
                    items:
                      type: object
                      properties:
                        disk_task:
                          type: string
                          description: iaas 创建硬盘任务ID
                          example: 3cabf143-5096-481f-9cf9-cc741c23166d
                        flag:
                          type: integer
                          description: >
                            iaas服务申请完成标志
                            * 0 - 成功完成
                            * 11 - 云主机服务申请失败
                            * 21 - 网卡服务申请失败
                            * 31 - 云硬盘服务申请失败
                          example: 0
                        host_ip:
                          type: string
                          description: 云主机管理段IP
                          example: 172.18.2.219
                        host_task:
                          type: string
                          description: iaas 创建云主机任务ID
                          example: 53cf14f6-7b71-44e8-b315-bce12a415371
                        host_uuid:
                          type: string
                          description: 云主机uuid
                          example: cc2c0625-2ae1-41fc-b87d-80b495571962
                        int_id:
                          type: string
                          description: db实例ID
                          example: bf7168b6-8b98-4dda-89e6-98db74fff339
                        message:
                          type: string
                          description: 服务申请状态描述
                          example: server deployment, please wait patiently
                        net_task:
                          type: string
                          description: iaas 创建网卡任务ID
                          example: cbf9b357-01ae-4508-9b58-144a621b6491
                        role:
                          type: integer
                          example: 2
                          description: >
                            角色类型:
                            * 1 - 主库
                            * 2 - 从库
                            * 3 - 从库
                            * 4 - rs角色
                        service_ip:
                          type: string
                          description: 用户段IP
                          example: 10.5.216.164
                  group_id:
                    type: string
                    example: 8vi356hj
                    description: 组ID
  /ops/redis/{int_id}:
    post:
      tags: [Redis - 实例操作]
      summary: start、stop、reboot、offline instance
      description: 对实例进行启动，关闭，重启，下线操作
      parameters:
        - name: int_id
          in: path
          required: true
          description: 实例ID
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                ops_type:
                  type: integer
                  example: 1
                  description: >
                    操作类型:
                    * 1 - 启动
                    * 2 - 关闭
                    * 3 - 重启
                    * 4 - 下线
      responses:
        '202':
          description: Created
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    description: 成功标志
                    example: True
                  task:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: string
                          description: 任务ID
                          example: 3cabf143-5096-481f-9cf9-cc741c23166d
                        msg:
                          type: string
                          example: 实例启动
                          description: >
                            任务说明：
                            * 实例启动
                            * 实例关闭
                            * 实例重启
                            * 实例删除
  /conf/redis/{int_id}:
    get:
      tags: [Redis - 参数配置]
      summary: Get  databases parameters info
      description: 获取Redis参数配置信息
      parameters:
        - name: int_id
          in: path
          required: true
          description: 实例ID
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: 参数详情
          content:
            application/json:
              schema:
                type: object
                properties:
                  appendfsync:
                    type: string
                    example: everysec
                    description: appendfsync
                  appendonly:
                    type: string
                    example: no
                    description: appendonly
                  hash-max-ziplist-entries:
                    type: integer
                    example: 512
                    description: hash-max-ziplist-entries
                  hash-max-ziplist-value:
                    type: integer
                    example: 64
                    description: hash-max-ziplist-value
                  list-max-ziplist-entries:
                    type: integer
                    example: 512
                    description: list-max-ziplist-entries
                  list-max-ziplist-value:
                    type: integer
                    example: 64
                    description: list-max-ziplist-value
                  maxclients:
                    type: integer
                    example: 100000
                    description: maxclients
                  maxmemory-policy:
                    type: string
                    example: allkeys-lru
                    description: maxmemory-policy
                  maxmemory-samples:
                    type: string
                    example: 3
                    description: maxmemory-samples
                  no-appendfsync-on-rewrite:
                    type: string
                    example: no
                    description: no-appendfsync-on-rewrite
                  port:
                    type: integer
                    example: 20017
                    description: port
                  repl-timeout:
                    type: integer
                    example: 60
                    description: repl-timeout
                  save:
                    type: string
                    example: 900 1 300 10 60 1000
                    description: save
                  set-max-intset-entries:
                    type: integer
                    example: 512
                    description: set-max-intset-entries
                  slaveof:
                    type: string
                    example: '0.0.0.0 6379'
                    description: slaveof
                  slowlog-log-slower-than:
                    type: integer
                    example: 10000
                    description: slowlog-log-slower-than
                  slowlog-max-len:
                    type: integer
                    example: 128
                    description: slowlog-max-len
                  tcp-keepalive:
                    type: integer
                    example: 0
                    description: tcp-keepalive
                  timeout:
                    type: integer
                    example: 300
                    description: timeout
                  zset-max-ziplist-entries:
                    type: integer
                    example: 128
                    description: zset-max-ziplist-entries
                  zset-max-ziplist-value:
                    type: integer
                    example: 64
                    description: zset-max-ziplist-value

    post:
      tags: [Redis - 参数配置]
      summary: redis config parameter
      description: 设置Redis参数配置
      parameters:
        - name: int_id
          in: path
          required: true
          description: 实例ID
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                data:
                  type: array
                  description: 同get方法返回参数，可传递多个
                  items:
                    type: object
                    description: 同get方法返回参数
                    properties:
                      appendfsync:
                        type: string
                        example: no

      responses:
        '200':
          description: Created
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    example: True
                    description: 描述
  /slowlog/redis/{int_id}:
    get:
      tags: [Redis - 慢查询]
      summary: Get  redisslowlog
      description: 获取实例慢查询信息
      parameters:
        - name: int_id
          in: path
          required: true
          description: 实例ID
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: 请求返回
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    description: 成功标志
                    example: True
                  data:
                    type: array
                    description: 慢查询信息取最近30条
                    items:
                      type: object
                      properties:
                        command:
                          type: string
                          description: 慢查询命令
                          example: DEL addviews_7661170
                        duration:
                          type: integer
                          description: 耗时
                          example: 22929
                        id:
                          type: integer
                          description: 编号
                          example: 114784
                        start_time:
                          type: integer
                          description: 开始时间
                          example: 1469587519
                  total:
                    type: integer
                    description: 慢查询总数
                    example: 1
    delete:
      tags: [Redis - 慢查询]
      summary: clear slowlog list
      description: 清空Redis慢查询列表
      parameters:
        - name: int_id
          in: path
          required: true
          description: 实例ID
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: 请求返回
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    description: 成功标志
                    example: True
  /monitor/redis/{int_id}:
    get:
      tags: [采样分析]
      summary: all databasetype sampling info
      description: 查询所有数据库类型采样分析记录
      parameters:
        - name: int_id
          in: path
          required: true
          description: 实例ID
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: 请求返回
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    description: 成功标志
                    example: True
                  data:
                    type: array
                    description: 采样任务详情
                    items:
                      type: object
                      properties:
                        flag:
                          type: integer
                          description: >
                            采样任务标志：
                            * 0 - 采样完成
                            * 99 - 初始化
                            * 111 - 失败
                          example: 0
                        flag_display:
                          type: string
                          description: 采样说明
                          example: 采样完成
                        start_time:
                          type: string
                          description: 采样开始时间
                          example: '2018-04-03T15:27:37+00:00'
                        end_time:
                          type: string
                          description: 采样结束时间
                          example: '2018-04-03T15:28:39+00:00'
                        vcount:
                          type: integer
                          description: 采样时长/采样数据包
                          example: 60
                        id:
                          type: integer
                          description: 行号
                          example: 160
    post:
      tags: [Redis - 采样分析]
      summary: redis sampling
      description: 执行Redis采样分析
      parameters:
        - name: int_id
          in: path
          required: true
          description: 实例ID
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                count:
                  type: integer
                  example: 60
                  description: 采样时长 单位秒

      responses:
        '202':
          description: 请求返回
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    description: 成功标志
                    example: True
                  task:
                    type: array
                    description: 任务描述
                    items:
                      type: object
                      properties:
                        id:
                          type: string
                          description: 任务ID
                          example: 4013a014-018c-44bd-848f-edda43d0409b
                        msg:
                          type: string
                          description: 任务描述
                          example:  监控设置
  /monitor/redis/{int_id}/id/{id}:
    get:
      tags: [Redis - 采样分析]
      summary: redis sampling info
      description: 查询redis采样结果
      parameters:
        - name: int_id
          in: path
          required: true
          description: 实例ID
          schema:
            type: string
            format: uuid
        - name: id
          in: path
          required: true
          description: 行号ID， 根据通用型采样分析记录查询获得
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: 请求返回
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    description: 成功标志
                    example: True
                  data:
                    type: array
                    description: 采样任务详情
                    items:
                      type: object
                      properties:
                        flag:
                          type: integer
                          description: >
                            采样任务标志：
                            * 0 - 采样完成
                            * 99 - 初始化
                            * 111 - 失败
                          example: 0
                        flag_display:
                          type: string
                          description: 采样说明
                          example: 采样完成
                        start_time:
                          type: string
                          description: 采样开始时间
                          example: '2018-04-03T15:27:37+00:00'
                        end_time:
                          type: string
                          description: 采样结束时间
                          example: '2018-04-03T15:28:39+00:00'
                        vcount:
                          type: integer
                          description: 采样时长/采样数据包
                          example: 60
                        id:
                          type: integer
                          description: 行号
                          example: 160
                        monitor_result:
                          type: string
                          description: 采样结果说明
                          example:  'Overall Stats
                ========================================
                    Lines Processed   71
                    Commands/Sec      1.31

                Top Prefixes
                ========================================
                    currency_v2   25  (35.21%)
                    cache         18  (25.35%)

                Top Keys
                ========================================
                    ASD.230823r7DTs..2faooooooo,asdMzP   20  (28.17%)
                    cache:Yii.CUrlManager.rules          18  (25.35%)
                    currency_v2:cer:35540474             7   (9.86%

                Top Commands
                ========================================
                    GET    39  (54.93%)
                    AUTH   20  (28.17%)
                    SET    3   (4.23%)
                    INFO   2   (2.82%)
                    DEL    1   (1.41%)
                Command Time (microsecs)
                ========================================
                    Median   1570.0
                    75%      390700.0
                    90%      3221970.0
                    99%      13909409.0

                Heaviest Commands (microsecs)
                ========================================
                    GET    46968941.5
                    INFO   4993768.2

                Slowest Calls
                ========================================
                    13909409.0   "GET" "currency_v2:cer:35540474"
                    4927520.0    "GET" "currency_v2:cer:137846244"'
  /failover/redis/{int_id}:
    put:
      tags: [Redis - 从库相关]
      summary: redis failover
      description: Redis从库切换成主库
      parameters:
        - name: int_id
          in: path
          required: true
          description: 实例ID
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: 请求返回
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    description: 成功标志
                    example: True
        '400':
          description: 请求返回
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    description: 失败标志
                    example: False
                  message:
                    type: string
                    description: 错误信息
                    example: 连接异常
  /redis/memory/{int_id}:
    post:
      tags: [memory功能]
      summary:  redis memory command
      description: Redis Memory功能集合
      parameters:
        - name: int_id
          in: path
          required: true
          description: 实例ID
          example: 612252e2-de48-4d59-8721-dfe112fdaeaa
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                ops_cmd:
                  type: string
                  example: memory usage
                  description: >
                        操作类型:
                        * memory usage
                        * memory stats
                        * memory doctor
                        * memory purge
                        * memory malloc-stats
                key_name:
                   type: string
                   example: key_name
                   description: key名称，memory usage 查询某个key的内存使用情况

      responses:
        '200':
          description: 请求成功返回
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    description: 成功标志
                    example: True
                  data:
                    type: string
                    description: 结果描述
  /server/mongodb:
    post:
      tags: [MongoDB - 实例创建]
      summary: Creates a new mongodb instance.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                int_num:
                  type: integer
                  example: 1
                  description: 申请实例组数
                host_type:
                  type: integer
                  example: 1
                  description: >
                    主机类型:
                    * 1-虚拟机
                    * 2-物理机
                dbtype:
                  type: string
                  example: mongodb
                  description: >
                    数据库类型:
                    * - mysql
                    * - redis
                    * - mongodb
                rsname:
                  type: string
                  example: ""
                  description: rs复制集名称 默认空。当roletype=4时 未传递rsname 则以group_id命名
                host_info:
                  type: array
                  description: 主机信息 默认为空 host_type=2时必填.host_type=1,roletype=2 （同时设置role_flag=1） 必填
                  items:
                    type: object
                    properties:
                      ip:
                        type: string
                        description: ip信息
                      port:
                        type: integer
                        example: 27017
                        description: 端口信息
                      role_flag:
                        type: integer
                        example: 1
                        description: >
                          角色标志:
                          * 1 - 主实例标志
                          * 2 - 从实例标志/secondary节点标志
                          * 3 - secondary节点标志/单实例标志
                roletype:
                  type: integer
                  example: 1
                  description:  >
                    部署类型:
                    * 1 - 主从模式
                    * 2 - 单从模式
                    * 3 - 单实例模式
                    * 4 - mongodb-rs复制集
                zone:
                  type: string
                  example: a
                  description: 可用区
                version:
                  type: string
                  example: 3.2
                  description: >
                    数据库版本:
                    * mysql - 5.6,5.7
                    * redis -  2.8
                    * mongodb - 3.2
                nettype:
                  type: integer
                  example: 1
                  description: >
                    网络类型:
                    * 1 - 专有网络
                    * 2 - 经典网络
                vpc:
                  type: string
                  example: vpc-02c270dc 10.59.0.0/16 仓科内网
                  description: VPC描述说明
                subnet:
                  type: string
                  example: 10.5.217.0/24
                  description: 用户网段
                subnetRef:
                  type: string
                  example: e0e661c6-ab9f-42eb-b320-e660423487cc
                  description: 用户网段UUID
                style:
                  type: string
                  example: ""
                  description: 规格描述说明
                flavorRef:
                  type: string
                  example: rds.mongodb.small
                  description: 规格编码
                stroage:
                  type: string
                  example: 50
                  description: 硬盘容量
                strotype:
                  type: string
                  example: 11
                  description: >
                    存储类型 :
                    * 10 - 容量本地
                    * 11 - 容量云盘
                    * 20 - 性能本地
                    * 21 - 性能云盘
                user:
                  type: string
                  example: root
                  description: 用户名
                password:
                  type: string
                  example: dfoi3af
                  description: 密码
                backup_flag:
                  type: integer
                  example: 1
                  description: >
                    备份设置标志:
                    * 0 - 不备份
                    * 1 - 备份
                slow_flag:
                  type: integer
                  example: 0
                  description: >
                    慢查询开启标志:
                    * 0 - 关闭
                    * 1 - 开启
                injection_flag:
                  type: integer
                  example: 0
                  description: >
                    注入保护开启标志:
                    * 0 - 关闭
                    * 1 - 开启
                protect:
                  type: integer
                  example: 0
                  description: >
                    过载保护开启标志:
                    * 0 - 关闭
                    * 1 - 开启
                sleep_prec:
                  type: integer
                  example: 80
                  description: 连数百分比 默认80,当protect启动时生效
                parameters:
                  type: array
                  description: 参数配置，针对专家模式 默认为空
                  example: []
                  items:
                    type: object
                tag:
                  type: array
                  description: 标签 默认空
                  example: []
                  items:
                    type: string
                dsc:
                  type: string
                  example: "swagger editor"
                  description: 备注说明
                module:
                  type: integer
                  example: 0
                  description: >
                    部署模式 :
                      * 0 - 简单模式
                      * 1 - 专家模式
      responses:
        '202':
          description: Created
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    description: 成功标志
                    example: True
                  data:
                    type: array
                    items:
                      type: object
                      properties:
                        disk_task:
                          type: string
                          description: iaas 创建硬盘任务ID
                          example: 3cabf143-5096-481f-9cf9-cc741c23166d
                        flag:
                          type: integer
                          description: >
                            iaas服务申请完成标志
                            * 0 - 成功完成
                            * 11 - 云主机服务申请失败
                            * 21 - 网卡服务申请失败
                            * 31 - 云硬盘服务申请失败
                          example: 0
                        host_ip:
                          type: string
                          description: 云主机管理段IP
                          example: 172.18.2.219
                        host_task:
                          type: string
                          description: iaas 创建云主机任务ID
                          example: 53cf14f6-7b71-44e8-b315-bce12a415371
                        host_uuid:
                          type: string
                          description: 云主机uuid
                          example: cc2c0625-2ae1-41fc-b87d-80b495571962
                        int_id:
                          type: string
                          description: db实例ID
                          example: bf7168b6-8b98-4dda-89e6-98db74fff339
                        message:
                          type: string
                          description: 服务申请状态描述
                          example: server deployment, please wait patiently
                        net_task:
                          type: string
                          description: iaas 创建网卡任务ID
                          example: cbf9b357-01ae-4508-9b58-144a621b6491
                        role:
                          type: integer
                          example: 2
                          description: >
                            角色类型:
                            * 1 - 主库
                            * 2 - 从库
                            * 3 - 从库
                            * 4 - rs角色
                        service_ip:
                          type: string
                          description: 用户段IP
                          example: 10.5.216.164
                  group_id:
                    type: string
                    example: 8vi356hj
                    description: 组ID
  /ops/mongodb/{int_id}:
    post:
      tags: [MongoDB - 实例操作]
      summary: start、stop、reboot、offline instance
      description: 对实例进行启动，关闭，重启，下线操作
      parameters:
        - name: int_id
          in: path
          required: true
          description: 实例ID
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                ops_type:
                  type: integer
                  example: 1
                  description: >
                    操作类型:
                    * 1 - 启动
                    * 2 - 关闭
                    * 3 - 重启
                    * 4 - 下线
      responses:
        '202':
          description: Created
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    description: 成功标志
                    example: True
                  task:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: string
                          description: 任务ID
                          example: 3cabf143-5096-481f-9cf9-cc741c23166d
                        msg:
                          type: string
                          example: 实例启动
                          description: >
                            任务说明：
                            * 实例启动
                            * 实例关闭
                            * 实例重启
                            * 实例删除
  /mongodb/dbname/{int_id}:
    get:
      tags: [MongoDB - 数据库管理]
      summary: Get  databases info from localhost
      description: 在远端查询实例数据库详情
      parameters:
        - name: int_id
          in: path
          required: true
          description: 实例ID
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: 数据库信息
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    description: 成功标志
                    example: True
                  data:
                    type: array
                    description: 数据库信息列表
                    items:
                      type: object
                      properties:
                        dbname:
                          type: string
                          description: 数据库名
                          example: blade
                        int_id:
                          type: string
                          description: 实例ID
                          example: 43910f58-4f48-4086-a590-9ef2f63698f9
                        size:
                          type: integer
                          description: 数据库大小
                          example: 4096

    post:
      tags: [MongoDB - 数据库管理]
      summary: create a database for mongodb
      description: 创建数据库
      parameters:
        - name: int_id
          in: path
          required: true
          description: 实例ID
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                dbname:
                  type: string
                  description: 数据库名
                  example: icloud

      responses:
        '200':
          description: Created
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    description: 成功标志
                    example: True
                  message:
                    type: string
                    example: success
                    description: 描述
        '400':
          description: Created
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    description: 失败标志
                    example: False
                  message:
                    type: string
                    example: create database fail
                    description: 描述
  /opsconf/{int_id}:
    get:
      tags: [MySQL - 参数配置]
      summary: Get  databases parameters info from webserver
      description: /conf/mysql/的get方法获取的数据刷新到web服务数据库的记录
      parameters:
        - name: int_id
          in: path
          required: true
          description: 实例ID
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: 请求返回
          content:
            application/json:
              schema:
                type: object
                properties:
                  back_log:
                    type: integer
                    description: back_log
                    example: 1024
                  character_set_server:
                    type: string
                    description: character_set_server
                    example: utf8
                  expire_logs_days:
                    type: integer
                    description: expire_logs_days
                    example: 10
                  ft_min_word_len:
                    type: integer
                    description: ft_min_word_len
                    example: 4
                  gtid_mode:
                    type: string
                    description: gtid_mode
                    example: ON
                  innodb_buffer_pool_instances:
                    type: integer
                    description: innodb_buffer_pool_instances
                    example: 1
                  innodb_flush_log_at_trx_commit:
                    type: integer
                    description: innodb_flush_log_at_trx_commit
                    example: 1
                  innodb_flush_method:
                    type: integer
                    description: innodb_flush_method
                    example: O_DIRECT
                  innodb_flush_neighbors:
                    type: integer
                    description: innodb_flush_neighbors
                    example: 1
                  innodb_io_capacity:
                    type: integer
                    description: innodb_io_capacity
                    example: 2000
                  innodb_max_dirty_pages_pct:
                    type: integer
                    description: innodb_max_dirty_pages_pct
                    example: 50.00000
                  innodb_read_io_threads:
                    type: integer
                    description: innodb_read_io_threads
                    example: 8
                  innodb_write_io_threads:
                    type: integer
                    description: innodb_write_io_threads
                    example: 8
                  interactive_timeout:
                    type: integer
                    description: interactive_timeout
                    example: 1000
                  log_bin_trust_function_creators:
                    type: string
                    description: log_bin_trust_function_creators
                    example: OFF
                  log_queries_not_using_indexes:
                    type: string
                    description: log_queries_not_using_indexes
                    example: OFF
                  long_query_time:
                    type: integer
                    description: long_query_time
                    example: 1.0000
                  lower_case_table_names:
                    type: integer
                    description: lower_case_table_name
                    example: 0
                  max_allowed_packet:
                    type: integer
                    description: max_allowd_packet
                    example: 33554432
                  max_connect_errors:
                    type: integer
                    description: max_connect_errors
                    example: 100000
                  max_connections:
                    type: integer
                    description: max_connections
                    example: 300
                  open_files_limit:
                    type: integer
                    description: open_files_limit
                    example: 8192
                  query_cache_size:
                    type: integer
                    description: query_cache_size
                    example: 8388608
                  query_cache_type:
                    type: string
                    description: query_cache_type
                    example: OFF
                  skip_name_resolve:
                    type: string
                    description: skip_name_resolve
                    example: ON
                  sql_mode:
                    type: string
                    description: sql_mode
                    example: NO_ENGINE_SUBSTITUTION
                  sync_binlog:
                    type: integer
                    description: sync_binlog
                    example: 1
                  table_open_cache:
                    type: integer
                    description: table_open_cache
                    example: 2048
                  thread_cache_size:
                    type: integer
                    description: thread_cache_size
                    example: 256
                  wait_timeout:
                    type: integer
                    description: wait_timeout
                    example: 1000
  /mongodb/dbpriv/{int_id}:
    get:
      tags: [MongoDB -权限管理]
      summary: Get  privileges for webserver database
      description: 获取MongoDB服务端存储的权限信息
      parameters:
        - name: int_id
          in: path
          required: true
          description: 实例ID
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: 请求返回
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    description: 成功标志
                    example: True
                  data:
                    type: array
                    description: 权限列表信息
                    items:
                      type: object
                      properties:
                        int_id:
                          type: string
                          description: 实例ID
                        user:
                          type: string
                          description: 用户名
                        authenticate_db:
                          type: string
                          description: 登入认证数据库
                        roles:
                          type: string
                          description: 角色信息
    post:
      tags: [MongoDB -权限管理]
      summary: mongodb ops privileges
      description: mongodb权限操作
      parameters:
        - name: int_id
          in: path
          required: true
          description: 实例ID
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                pri_type:
                  type: string
                  example: grant
                  description: >
                    权限操作类型:
                    * create -  权限授予
                    * update -  权限修改
                    * get - 获取权限(从远端数据库刷新最新权限信息)
                    * changepwd - 修改密码
                    * drop -  删除用户
                pri:
                  type: array
                  example: ["readWrite"]
                  description: 权限信息
                  items:
                    type: string
                dbname:
                  type: string
                  example: icloud
                  description: 授权数据库
                authentication:
                  type: string
                  example: amdin
                  description: 登入认证数据库
                user:
                  type: string
                  example: blade
                  description: 用户名
                passwd:
                  type: string
                  example: blade
                  description: 密码



      responses:
        '200':
          description: 请求返回
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    description: 成功标志
                    example: True
                  data:
                    type: array
                    description: 当pri_type=get 时 展示权限信息
                    items:
                      type: object
                      properties:
                        int_id:
                          type: string
                          description: 实例ID
                        user:
                          type: string
                          description: 用户名
                        authenticate_db:
                          type: string
                          description: 登入认证数据库
                        roles:
                          type: string
                          description: 角色信息

        '201':
          description: 请求返回
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    description: 成功标志
                    example: False
                  message:
                    type: string
                    example: create failed
                    description: 操作失败描述
  /mongodb/secure/{int_id}:
    post:
      tags: [MongoDB -安全管理]
      summary: MongoDB config secure
      description: 设置MongoDB 慢查询、响应时长过载保护
      parameters:
        - name: int_id
          in: path
          required: true
          description: 实例ID
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                opstype:
                  type: string
                  example: slowlog
                  description: >
                    安全设置操作类型:
                    * slowlog - 慢查询
                    * protect - 响应时长过载保护
                opsflag:
                  type: integer
                  example: 1
                  description: >
                    开关设置:
                    * 0 - 关闭
                    * 1 - 开通
                opsvalue:
                  type: integer
                  example: 300
                  description: >
                    传递值:
                    * slowlog  单位 毫秒
                    * protect  单位 秒
                dbname:
                  type: string
                  example: icloud
                  description:  需要保护的数据库



      responses:
        '202':
          description: 请求返回
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    description: 成功标志
                    example: True
                  task:
                    type: array
                    description: 任务描述
                    items:
                      type: object
                      properties:
                        id:
                          type: string
                          description: 任务ID
                          example: 4013a014-018c-44bd-848f-edda43d0409b
                        msg:
                          type: string
                          description: 任务描述
                          example:  过载保护开启/过载保护关闭
        '200':
          description: 请求返回(slowlog设置返回)
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    description: 成功标志
                    example: True
                  message:
                    type: string
                    description: 设置成功描述
                    example: success
        '400':
          description: 请求返回(slowlog设置返回)
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    description: 失败标志
                    example: False
                  message:
                    type: string
                    description: 失败描述
                    example: set slolog fail
  /mongodb/secure/{int_id}/type/{vtype}:
    get:
      tags: [MongoDB -安全管理]
      summary: MongoDB query secure
      description: 查询MongoDB安全配置信息
      parameters:
        - name: int_id
          in: path
          required: true
          description: 实例ID
          schema:
            type: string
            format: uuid
        - name: vtype
          in: path
          required: true
          description: >
            安全设置类型：
              * slowlog - 慢查询
              * protect - 响应时长过载保护
          schema:
            type: string
            example: slowlog
      responses:
        '200':
          description: 请求返回
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    description: 成功标志
                    example: True
                  data:
                    type: array
                    description: 安全服务信息
                    items:
                      type: object
                      properties:
                        int_id:
                          type: string
                          description: 实例ID
                        ip:
                          type: string
                          description: ip信息
                        dbname:
                          type: string
                          description: 数据库名
                          example: icloud
                        opsflag:
                          type: integer
                          description:  >
                            服务状态:
                            * 0 - 关闭
                            * 1 - 开通
                            *  99 - 初始化
                          example: 1
                        opsvalue:
                          type: integer
                          description: 设置值 slowlog单位ms，protect单位s
                          example: 300
                        opstype:
                          type: string
                          example: slowlog
                          description: >
                            安全设置类型：
                              * slowlog - 慢查询
                              * protect - 响应时长过载保护
                        port:
                          type: integer
                          example: 27017
  /mongodb/slowlog/{int_id}/dbname/{dbname}:
    get:
      tags: [MongoDB - 慢查询]
      summary: MongoDB slowlogdetail
      description: 查询MongoDB最近50条慢查询信息
      parameters:
        - name: int_id
          in: path
          required: true
          description: 实例ID
          schema:
            type: string
            format: uuid
        - name: dbname
          in: path
          required: true
          description: 数据库名
          schema:
            type: string
      responses:
        '200':
          description: 请求返回
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    description: 成功标志
                    example: True
                  data:
                    type: array
                    description: 慢查询详情
                    items:
                      type: object
                      properties:
                        dbname:
                          type: string
                          description: 数据库名
                          example: icloud
                        docsexamined:
                          type: integer
                          description: 检索行数
                          example:  46637
                        execStats:
                          type: string
                          description: 执行状态
                          example: "{u'restoreState': 364, u'saveState': 364, u'isEOF': 0....}"
                        hasSortStage:
                          type: string
                          description: 排序使用分页
                          example: ""
                        host:
                          type: string
                          description: 远程客户端
                          example: 10.59.116.33
                        int_id:
                          type: string
                          description: 实例ID
                          example: bbda19e3-7a09-4243-9206-bf8d4e0585fa
                        keysexamined:
                          type: integer
                          description: 检索索引行数
                          example: 46637
                        lockinfo:
                          type: string
                          description: 锁信息
                          example: "{}"
                        millis:
                          type: integer
                          description: 执行时长ms
                          example: 102
                        nreturned:
                          type: integer
                          description: 返回行数
                          example: 24
                        opstype:
                          type: string
                          description: 语句类型
                          example: query
                        sqlinfo:
                          type: string
                          description: 语句
                          example: "{}"

                        tablename:
                          type: string
                          description: 表名
                          example: icloud.collected_data
                        user:
                          type: string
                          description: 用户名
                          example:  prog_admin@icloud
                        start_time:
                          type: string
                          description: 开始时间
                          example: '2017-09-19 03:11:17'
  /returnsafe/{int_id}/safe/{safe}:
    get:
      tags: [MySQL - 安全管理]
      summary: MySQL injection,protect info
      description: 获取MySQL实例SQLL注入和过载保护的历史记录
      parameters:
        - name: int_id
          in: path
          required: true
          description: 实例ID
          schema:
            type: string
            format: uuid
        - name: safe
          in: path
          required: true
          description: >
            类型：
            * injection
            * protect
          schema:
            type: string
      responses:
        '200':
          description: 请求返回
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    description: 成功标志
                    example: True
                  data:
                    type: array
                    description: 慢查询详情
                    items:
                      type: object
                      properties:
                        dbs:
                          type: string
                          description: 数据库名
                          example: icloud
                        command:
                          type: string
                          description: 命令类型
                          example:  Query
                        host:
                          type: string
                          description: 远程访问客户端
                          example: 10.59.116.33
                        int_id:
                          type: string
                          description: 实例ID
                          example: bbda19e3-7a09-4243-9206-bf8d4e0585fa
                        id:
                          type: integer
                          description: 行号
                          example: 5
                        ip:
                          type: string
                          description: 实例IP
                          example: 172.18.1.1
                        port:
                          type: integer
                          description: 端口
                          example: 3306
                        opstype:
                          type: string
                          description: >
                            类型：
                            * injection - 注入
                            * protect -  过载保护
                          example: protect
                        sqlinfo:
                          type: string
                          description: 语句
                          example: select sleep(500)

                        state:
                          type: string
                          description: 状态
                          example: User sleep
                        times:
                          type: integer
                          description: 时长
                          example:  201
                        user:
                          type: string
                          description: 用户名
                          example:  'prog_admin'
                        start_time:
                          type: string
                          description: 开始时间
                          example: '2017-09-19 03:11:17'
  /monitor/mongodb/{int_id}:
    post:
      tags: [MongoDB - 采样分析]
      summary: MongoDB sampling
      description: 执行MongoDB采样分析
      parameters:
        - name: int_id
          in: path
          required: true
          description: 实例ID
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                times:
                  type: integer
                  example: 60
                  description: 采样时长

      responses:
        '202':
          description: 请求返回
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    description: 成功标志
                    example: True
                  task:
                    type: array
                    description: 任务描述
                    items:
                      type: object
                      properties:
                        id:
                          type: string
                          description: 任务ID
                          example: 4013a014-018c-44bd-848f-edda43d0409b
                        msg:
                          type: string
                          description: 任务描述
                          example:  mmongodb采样
  /monitor/mongodb/{int_id}/task/{taskid}:
    get:
      tags: [MongoDB - 采样分析]
      summary: MongoDB sampling result
      description: 查询MongoDB采样分析结果
      parameters:
        - name: int_id
          in: path
          required: true
          description: 实例ID
          schema:
            type: string
            format: uuid
        - name: taskid
          in: path
          required: true
          description: 任务ID
          schema:
            type: string
            format: uuid

      responses:
        '200':
          description: 请求返回
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    description: 成功标志
                    example: True
                  data:
                    type: array
                    description: 分析结果
                    items:
                      type: object
                      properties:
                        id:
                          type: integer
                          description: 行号
                          example: 531
                        int_id:
                          type: string
                          description: 实例ID
                          example:  bbda19e3-7a09-4243-9206-bf8d4e0585fa
                        read_count:
                          type: integer
                          description: 读次数
                          example: 45
                        read_time:
                          type: integer
                          description: 读时长
                          example: 262
                        tablename:
                          type: string
                          description: 表名
                          example: p_act.form_show_data
                        task_id:
                          type: string
                          description: 任务id
                          example: d897cd76-1731-45b2-948f-675b7422036c
                        total_count:
                          type: integer
                          description: 总次数
                          example: 47
                        total_time:
                          type: integer
                          description: 总时长
                          example: 262
                        write_count:
                          type: integer
                          description: 写次数
                          example: 2
                        write_time:
                          type: integer
                          description: 写时长
                          example: 0


  /failover/server/{int_id}:
    post:
      tags: [IaaS相关]
      summary: config server style  but not fixed
      description: 提交Rds规格配置升降申请
      parameters:
        - name: int_id
          in: path
          required: true
          description: 实例ID
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                flavorRef:
                  type: string
                  example: rds.mysql.medium
                  description: 数据库规格信息

      responses:
        '200':
          description: 请求成功返回
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    description: 成功标志
                    example: True
        '201':
          description: 请求失败返回
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    description: 失败标志
                    example: False
                  message:
                    type: string
                    description: 失败原因
                    example: can not foud failover info
    put:
      tags: [IaaS相关]
      summary: reboot server fixed config
      description: 确认Rds规格配置升降申请(重启)
      parameters:
        - name: int_id
          in: path
          required: true
          description: 实例ID
          schema:
            type: string
            format: uuid

      responses:
        '200':
          description: 请求成功返回
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    description: 成功标志
                    example: True
        '201':
          description: 请求失败返回
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    description: 失败标志
                    example: False
                  message:
                    type: string
                    description: 失败原因
                    example: instance is not exist
  /dilate/disk/{int_id}:
    post:
      tags: [IaaS相关]
      summary:  increase disk
      description:  增加Rds的硬盘容量，只增不能减
      parameters:
        - name: int_id
          in: path
          required: true
          description: 实例ID
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                size:
                  type: integer
                  example: 50
                  description: 硬盘大小 单位G

      responses:
        '200':
          description: 请求成功返回
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    description: 成功标志
                    example: True
                  message:
                    type: string
                    description: 描述
                    example: success
        '201':
          description: 请求失败返回
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    description: 失败标志
                    example: False
                  message:
                    type: string
                    description: 失败原因
                    example: new size need more than  old size
  /iaas/opsnet/{int_id}:
    post:
      tags: [IaaS相关]
      summary:  add net
      description: 添加外网网卡
      parameters:
        - name: int_id
          in: path
          required: true
          description: 实例ID
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                zone:
                  type: string
                  example: a
                  description: 可用区
                subnetRef:
                  type: string
                  example: 79f54292-3ffd-4f3c-8ac5-2944204d54d9
                  description: 子网ID
                vpc:
                  type: string
                  example: 'vpc-1dc7f2b5: 仓科公网'
                  description: vpc描述， 可不传
                subnet:
                  type: string
                  example: 'vsw-79f54292: 117.27.238.64/26'
                  description: 子网描述, 可不传

      responses:
        '202':
          description: 请求成功返回
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    description: 成功标志
                    example: True
                  task:
                    type: array
                    description: 任务描述
                    items:
                      type: object
                      properties:
                        id:
                          type: string
                          description: 任务ID
                          example: 4013a014-018c-44bd-848f-edda43d0409b
                        msg:
                          type: string
                          description: 任务描述
                          example: 添加网卡IP
                        ip:
                          type: string
                          description: 新添加IP
                          example: 117.27.238.125
        '404':
          description: 请求失败返回
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    description: 失败标志
                    example: False
                  message:
                    type: string
                    description: 失败原因
                    example: wrong
    put:
      tags: [IaaS相关]
      summary:  delete net
      description: 删除外网网卡
      parameters:
        - name: int_id
          in: path
          required: true
          description: 实例ID
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                zone:
                  type: string
                  example: a
                  description: 可用区
                ip:
                  type: string
                  example: 117.27.238.125
                  description: 需要删除的网卡IP


      responses:
        '202':
          description: 请求成功返回
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    description: 成功标志
                    example: True
                  task:
                    type: array
                    description: 任务描述
                    items:
                      type: object
                      properties:
                        id:
                          type: string
                          description: 任务ID
                          example: 4013a014-018c-44bd-848f-edda43d0409b
                        msg:
                          type: string
                          description: 任务描述
                          example: 删除网卡IP
                        ip:
                          type: string
                          description: 删除IP
                          example: 117.27.238.125
        '404':
          description: 请求失败返回
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    description: 失败标志
                    example: False
                  message:
                    type: string
                    description: 失败原因
                    example: can not found nic_uuid
  /tag:
    post:
      tags: [标签管理]
      summary:  add tag
      description: 添加标签
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                name:
                  type: string
                  example: 'ddx'
                  description: 标签名
                key_value:
                  type: string
                  example: tag-xk2zbgt0
                  description: 标签值
                colour:
                  type: string
                  example: '#00a65a'
                  description: 标签颜色

      responses:
        '200':
          description: 请求成功返回
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    description: 成功标志
                    example: True
  /tag/{id}:
    put:
      tags: [标签管理]
      summary:  update tag
      description: 更新标签
      parameters:
        - name: id
          in: path
          required: true
          description: 行号
          example: style
          schema:
            type: integer
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                name:
                  type: string
                  example: 'ddx'
                  description: 标签名
                key_value:
                  type: string
                  example: tag-xk2zbgt0
                  description: 标签值
                colour:
                  type: string
                  example: '#00a65a'
                  description: 标签颜色

      responses:
        '200':
          description: 请求成功返回
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    description: 成功标志
                    example: True
    delete:
      tags: [标签管理]
      summary:  add tag
      description: 删除标签
      parameters:
        - name: id
          in: path
          required: true
          description: 行号
          example: style
          schema:
            type: integer
      responses:
        '200':
          description: 请求成功返回
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    description: 成功标志
                    example: True
  /backup/setting:
    get:
      tags:
        - backup
      description: 返回备份设置列表
      summary: Return all backup setting.
      parameters:
        - $ref: '#/components/parameters/pgnum'
        - $ref: '#/components/parameters/pgsize'
        - $ref: '#/components/parameters/GidInQuery'
      responses:
        '200':
          description: A list of backup settings.
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    $ref: '#/components/schemas/Instance/properties/ok'
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/BackupSetting'
                  pg:
                    $ref: '#/components/schemas/PageInfo'
                  RequestId:
                    $ref: '#/components/schemas/Instance/properties/RequestId'

  /backup/{int_id}/setting:
    get:
      tags:
        - backup
      description: 获取备份策略详情
      parameters:
        - $ref: '#/components/parameters/IntIDInPath'
      responses:
        200:
          description: backup setting infos
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    $ref: '#/components/schemas/Instance/properties/ok'
                  task:
                    $ref: '#/components/schemas/BackupSetting'
                  RequestId:
                    $ref: '#/components/schemas/Instance/properties/RequestId'
    post:
      tags:
        - backup
      description: 开启/编辑备份策略
      parameters:
        - $ref: '#/components/parameters/IntIDInPath'
      requestBody:
        description: ''
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                action:
                  type: string
                  example: add
                  description: 操作类型
                mode:
                  $ref: '#/components/schemas/BackupSetting/properties/mode'
                int_id:
                  $ref: '#/components/schemas/Instance/properties/int_id'
                group_id:
                  $ref: '#/components/schemas/Instance/properties/group_id'
                dbtype:
                  $ref: '#/components/schemas/Instance/properties/dbtype'
                dbname:
                  $ref: '#/components/schemas/Instance/properties/dbtype'
                datacycle:
                  $ref: '#/components/schemas/BackupSetting/properties/datacycle'
                logcycle:
                  $ref: '#/components/schemas/BackupSetting/properties/logcycle'
                logbak:
                  $ref: '#/components/schemas/BackupSetting/properties/logbak'
                starttime:
                  $ref: '#/components/schemas/BackupSetting/properties/starttime'
                backdir:
                  $ref: '#/components/schemas/BackupSetting/properties/backdir'
                backcron:
                  $ref: '#/components/schemas/BackupSetting/properties/backcron'
                status:
                  $ref: '#/components/schemas/BackupSetting/properties/status'
      responses:
        202:
          description: ''
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    $ref: '#/components/schemas/Instance/properties/ok'
                  task:
                    type: array
                    items:
                      $ref: '#/components/schemas/AsyncTaskBody'
                  RequestId:
                      $ref: '#/components/schemas/Instance/properties/RequestId'
        400:
          description: ''
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    $ref: '#/components/schemas/Instance/properties/ok'
                  message:
                    type: string
                    example: Specified Instance does not exist.
                  RequestId:
                    $ref: '#/components/schemas/Instance/properties/RequestId'

    delete:
      tags:
        - backup
      description: 关闭备份策略
      parameters:
        - $ref: '#/components/parameters/IntIDInPath'
      responses:
        202:
          description: ''
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    $ref: '#/components/schemas/Instance/properties/ok'
                  task:
                    type: array
                    items:
                      $ref: '#/components/schemas/AsyncTaskBody'
                  RequestId:
                      $ref: '#/components/schemas/Instance/properties/RequestId'

  /backup/history:
    get:
      tags:
        - backup
      description: 返回备份记录列表
      summary: Return all backup records.
      parameters:
        - $ref: '#/components/parameters/pgnum'
        - $ref: '#/components/parameters/pgsize'
        - $ref: '#/components/parameters/GidInQuery'
      responses:
        '200':
          description: A list of backup records.
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    $ref: '#/components/schemas/Instance/properties/ok'
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/BackupRecord'
                  pg:
                    $ref: '#/components/schemas/PageInfo'
                  RequestId:
                    $ref: '#/components/schemas/Instance/properties/RequestId'

  /backup/{int_id}/history:
    get:
      tags:
        - backup
      description: 返回备份记录列表
      summary: Return all backup records by int_id.
      parameters:
        - $ref: '#/components/parameters/IntIDInPath'
      responses:
        '200':
          description: A list of backup records by int_id.
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    $ref: '#/components/schemas/Instance/properties/ok'
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/BackupRecord'
                  pg:
                    $ref: '#/components/schemas/PageInfo'
                  RequestId:
                    $ref: '#/components/schemas/Instance/properties/RequestId'
    post:
      tags:
        - backup
      description: 上传备份记录信息
      parameters:
        - $ref: '#/components/parameters/IntIDInPath'
      requestBody:
        description: ''
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                mode:
                  $ref: '#/components/schemas/BackupSetting/properties/mode'
                int_id:
                  $ref: '#/components/schemas/Instance/properties/int_id'
                group_id:
                  $ref: '#/components/schemas/Instance/properties/group_id'
                dbtype:
                  $ref: '#/components/schemas/Instance/properties/dbtype'
                dbname:
                  $ref: '#/components/schemas/Instance/properties/dbtype'
                upload_mode:
                  $ref: '#/components/schemas/BackupRecord/properties/upload_mode'
                started_at:
                  $ref: '#/components/schemas/BackupRecord/properties/started_at'
                ended_at:
                  $ref: '#/components/schemas/BackupRecord/properties/ended_at'
                zone:
                  $ref: '#/components/schemas/BackupRecord/properties/zone'
                filemtime:
                  $ref: '#/components/schemas/BackupRecord/properties/filemtime'
                filesize:
                  $ref: '#/components/schemas/BackupRecord/properties/filesize'
                localpath:
                  $ref: '#/components/schemas/BackupRecord/properties/localpath'
                remotepath:
                  $ref: '#/components/schemas/BackupRecord/properties/remotepath'
                backup_type:
                  $ref: '#/components/schemas/BackupRecord/properties/backup_type'
                status:
                  $ref: '#/components/schemas/BackupRecord/properties/status'
      responses:
        200:
          description: ''
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    $ref: '#/components/schemas/Instance/properties/ok'
                  data:
                    $ref: '#/components/schemas/BackupRecord'
                  RequestId:
                      $ref: '#/components/schemas/Instance/properties/RequestId'
        500:
          description: ''
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    $ref: '#/components/schemas/Instance/properties/ok'
                  message:
                    type: string
                    example: message exception.
                  RequestId:
                    $ref: '#/components/schemas/Instance/properties/RequestId'

  /backup/{int_id}/expires/{expires}:
    get:
      tags:
        - backup
      description: 根据int_id返回过期expires备份记录列表
      summary: Return all backup records by int_id.
      parameters:
        - $ref: '#/components/parameters/IntIDInPath'
        - $ref: '#/components/parameters/ExpiresInPath'
      responses:
        '200':
          description: A list of backup records by int_id and expires.
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    $ref: '#/components/schemas/Instance/properties/ok'
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/BackupRecord'
                  RequestId:
                    $ref: '#/components/schemas/Instance/properties/RequestId'

  /backup/{int_id}/history/{bid}:
    put:
      tags:
        - backup
      description: 根据bid进行更新备份记录列表
      summary: update backup records by int_id and bid.
      parameters:
        - $ref: '#/components/parameters/IntIDInPath'
        - $ref: '#/components/parameters/BidInPath'
      responses:
        '200':
          description: update backup records by int_id and bid.
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    $ref: '#/components/schemas/Instance/properties/ok'
                  data:
                    $ref: '#/components/schemas/BackupRecord'
                  RequestId:
                    $ref: '#/components/schemas/Instance/properties/RequestId'
    delete:
      tags:
        - backup
      description: 根据bid进行删除备份记录列表
      summary: delete backup records by int_id and bid.
      parameters:
        - $ref: '#/components/parameters/IntIDInPath'
        - $ref: '#/components/parameters/BidInPath'
      responses:
        '200':
          description: delete backup records by int_id and bid.
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    $ref: '#/components/schemas/Instance/properties/ok'
                  message:
                    type: string
                    example: delete successfully
                    description: 返回信息
                  RequestId:
                    $ref: '#/components/schemas/Instance/properties/RequestId'

  /backup/{bid}/hisops:
    delete:
      tags:
        - backup
      description: 删除备份记录
      summary: delete backup record by bid
      parameters:
        - $ref: '#/components/parameters/BidInPath'
      responses:
        202:
          description: ''
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    $ref: '#/components/schemas/Instance/properties/ok'
                  message:
                    type: string
                    example: delete successfully
                    description: 返回信息
                  RequestId:
                      $ref: '#/components/schemas/Instance/properties/RequestId'

  /backup/{int_id}/manual:
    post:
      tags:
        - backup
      description: 手动(单次)备份
      summary: Single backup
      parameters:
        - $ref: '#/components/parameters/IntIDInPath'
      requestBody:
        description: ''
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                action:
                  type: string
                  example: backup
                  description: 操作类型
                mode:
                  $ref: '#/components/schemas/BackupSetting/properties/mode'
                dbname:
                  type: array
                  items:
                    $ref: '#/components/schemas/BackupRecord/properties/dbname'
              required:
                - action
                - mode
      responses:
        202:
          description: ''
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    $ref: '#/components/schemas/Instance/properties/ok'
                  task:
                    type: array
                    items:
                      $ref: '#/components/schemas/AsyncTaskBody'
                  RequestId:
                      $ref: '#/components/schemas/Instance/properties/RequestId'
        400:
          description: ''
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    $ref: '#/components/schemas/Instance/properties/ok'
                  message:
                    type: string
                    example: Specified Instance does not exist.
                  RequestId:
                    $ref: '#/components/schemas/Instance/properties/RequestId'

  /restore/mysql:
    post:
      tags:
        - restore
      description: 通过备份文件进行MySQL恢复
      summary: mysql restore by backup file.
      requestBody:
        description: ''
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                bid:
                  $ref: '#/components/schemas/BackupSetting/properties/id'
                action:
                  type: string
                  example: restore
                  description: 操作类型
                int_num:
                  type: integer
                  example: 1
                  description: 创建虚机类型
                host_type:
                  $ref: '#/components/schemas/BackupSetting/properties/hosttype'
                dbtype:
                  $ref: '#/components/schemas/Instance/properties/dbtype'
                master_ip:
                  $ref: '#/components/schemas/Instance/properties/ip'
                master_port:
                  $ref: '#/components/schemas/Instance/properties/port'
                slave_ip:
                  $ref: '#/components/schemas/Instance/properties/ip'
                slave_port:
                  $ref: '#/components/schemas/Instance/properties/port'
                zone:
                  $ref: '#/components/schemas/BackupRecord/properties/zone'
                roletype:
                  $ref: '#/components/schemas/Instance/properties/role'
                version:
                  $ref: '#/components/schemas/Instance/properties/version'
                nettype:
                  type: integer
                  example: 1
                  description: 网络类型
                vpc:
                  type: string
                  example: vpc-xfdfd
                  description: vpc描述
                subnet:
                  type: string
                  example: 10.59.10.0/24
                  description: 用户网段子网
                subnetRef:
                  type: string
                  format: uuid
                  example: 529c59f2-b29f-4c66-813a-76195bdd6893
                  description: 用户子网uuid
                style:
                  type: string
                  example: style
                  description: 规格
                flavorRef:
                  type: string
                  format: uuid
                  example: 529c59f2-b29f-4c66-813a-76195bdd6893
                  description: 规格uuid
                stroage:
                  type: integer
                  example: 50
                  description: 磁盘大小,单位GB
                strotype:
                  type: integer
                  example: 10
                  description: 磁盘类型
                user:
                  type: string
                  example: root
                  description: 用户名
                password:
                  type: string
                  example: password
                  description: 密码
                backup_flag:
                  $ref: '#/components/schemas/Instance/properties/backup_flag'
                slow_flag:
                  $ref: '#/components/schemas/Instance/properties/slow_flag'
                injection_flag:
                  $ref: '#/components/schemas/Instance/properties/injection_flag'
                protect:
                  $ref: '#/components/schemas/Instance/properties/protect'
                sleep_prec:
                  $ref: '#/components/schemas/Instance/properties/sleep_prec'
                dsc:
                  $ref: '#/components/schemas/Instance/properties/ins_usage'
                tags:
                  $ref: '#/components/schemas/Instance/properties/tags'
                parameters:
                  type: array
                  description: 专家模式参数设置
                  items:
                    type: object
                module:
                  type: integer
                  example: 0
                  description: 部署方式
                isbinlog:
                  type: integer
                  example: 0
                  description: 是否基于点时间恢复 0否 1是
                point_time:
                  type: string
                  format: date-time
                  example: "2018-02-13T02:28:28+00:00"
                  description: 基于点时间恢复的时间
      responses:
        200:
          description: ''
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    $ref: '#/components/schemas/Instance/properties/ok'
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/InstallTaskBody'
                  group_id:
                    $ref: '#/components/schemas/Instance/properties/group_id'
                  RequestId:
                      $ref: '#/components/schemas/Instance/properties/RequestId'
        500:
          description: ''
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    $ref: '#/components/schemas/Instance/properties/ok'
                  message:
                    type: string
                    example: message exception.
                  RequestId:
                    $ref: '#/components/schemas/Instance/properties/RequestId'

  /restore/redis:
    post:
      tags:

        - restore
      description: 通过备份文件进行Redis恢复
      summary: redis restore by backup file.
      requestBody:
        description: ''
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                bid:
                  $ref: '#/components/schemas/BackupSetting/properties/id'
                action:
                  type: string
                  example: restore
                  description: 操作类型
                int_num:
                  type: integer
                  example: 1
                  description: 创建虚机类型
                host_type:
                  $ref: '#/components/schemas/BackupSetting/properties/hosttype'
                dbtype:
                  $ref: '#/components/schemas/Instance/properties/dbtype'
                master_ip:
                  $ref: '#/components/schemas/Instance/properties/ip'
                master_port:
                  $ref: '#/components/schemas/Instance/properties/port'
                slave_ip:
                  $ref: '#/components/schemas/Instance/properties/ip'
                slave_port:
                  $ref: '#/components/schemas/Instance/properties/port'
                zone:
                  $ref: '#/components/schemas/BackupRecord/properties/zone'
                roletype:
                  $ref: '#/components/schemas/Instance/properties/role'
                version:
                  $ref: '#/components/schemas/Instance/properties/version'
                nettype:
                  type: integer
                  example: 1
                  description: 网络类型
                vpc:
                  type: string
                  example: vpc-xfdfd
                  description: vpc描述
                subnet:
                  type: string
                  example: 10.59.10.0/24
                  description: 用户网段子网
                subnetRef:
                  type: string
                  format: uuid
                  example: 529c59f2-b29f-4c66-813a-76195bdd6893
                  description: 用户子网uuid
                style:
                  type: string
                  example: style
                  description: 规格
                flavorRef:
                  type: string
                  format: uuid
                  example: 529c59f2-b29f-4c66-813a-76195bdd6893
                  description: 规格uuid
                stroage:
                  type: integer
                  example: 50
                  description: 磁盘大小,单位GB
                strotype:
                  type: integer
                  example: 10
                  description: 磁盘类型
                user:
                  type: string
                  example: root
                  description: 用户名
                password:
                  type: string
                  example: password
                  description: 密码
                backup_flag:
                  $ref: '#/components/schemas/Instance/properties/backup_flag'
                slow_flag:
                  $ref: '#/components/schemas/Instance/properties/slow_flag'
                injection_flag:
                  $ref: '#/components/schemas/Instance/properties/injection_flag'
                protect:
                  $ref: '#/components/schemas/Instance/properties/protect'
                sleep_prec:
                  $ref: '#/components/schemas/Instance/properties/sleep_prec'
                dsc:
                  $ref: '#/components/schemas/Instance/properties/ins_usage'
                tags:
                  $ref: '#/components/schemas/Instance/properties/tags'
                parameters:
                  type: array
                  description: 专家模式参数设置
                  items:
                    type: object
                module:
                  type: integer
                  example: 0
                  description: 部署方式
      responses:
        200:
          description: ''
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    $ref: '#/components/schemas/Instance/properties/ok'
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/InstallTaskBody'
                  group_id:
                    $ref: '#/components/schemas/Instance/properties/group_id'
                  RequestId:
                      $ref: '#/components/schemas/Instance/properties/RequestId'
        500:
          description: ''
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    $ref: '#/components/schemas/Instance/properties/ok'
                  message:
                    type: string
                    example: message exception.
                  RequestId:
                    $ref: '#/components/schemas/Instance/properties/RequestId'

  /restore/mongodb:
    post:
      tags:
        - restore
      description: 通过备份文件进行MongoDB恢复
      summary: MongoDB restore by backup file.
      requestBody:
        description: ''
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                bid:
                  $ref: '#/components/schemas/BackupSetting/properties/id'
                action:
                  type: string
                  example: restore
                  description: 操作类型
                int_num:
                  type: integer
                  example: 1
                  description: 创建虚机类型
                host_type:
                  $ref: '#/components/schemas/BackupSetting/properties/hosttype'
                dbtype:
                  $ref: '#/components/schemas/Instance/properties/dbtype'
                master_ip:
                  $ref: '#/components/schemas/Instance/properties/ip'
                master_port:
                  $ref: '#/components/schemas/Instance/properties/port'
                slave_ip:
                  $ref: '#/components/schemas/Instance/properties/ip'
                slave_port:
                  $ref: '#/components/schemas/Instance/properties/port'
                zone:
                  $ref: '#/components/schemas/BackupRecord/properties/zone'
                roletype:
                  $ref: '#/components/schemas/Instance/properties/role'
                version:
                  $ref: '#/components/schemas/Instance/properties/version'
                nettype:
                  type: integer
                  example: 1
                  description: 网络类型
                vpc:
                  type: string
                  example: vpc-xfdfd
                  description: vpc描述
                subnet:
                  type: string
                  example: 10.59.10.0/24
                  description: 用户网段子网
                subnetRef:
                  type: string
                  format: uuid
                  example: 529c59f2-b29f-4c66-813a-76195bdd6893
                  description: 用户子网uuid
                style:
                  type: string
                  example: style
                  description: 规格
                flavorRef:
                  type: string
                  format: uuid
                  example: 529c59f2-b29f-4c66-813a-76195bdd6893
                  description: 规格uuid
                stroage:
                  type: integer
                  example: 50
                  description: 磁盘大小,单位GB
                strotype:
                  type: integer
                  example: 10
                  description: 磁盘类型
                user:
                  type: string
                  example: root
                  description: 用户名
                password:
                  type: string
                  example: password
                  description: 密码
                backup_flag:
                  $ref: '#/components/schemas/Instance/properties/backup_flag'
                slow_flag:
                  $ref: '#/components/schemas/Instance/properties/slow_flag'
                injection_flag:
                  $ref: '#/components/schemas/Instance/properties/injection_flag'
                protect:
                  $ref: '#/components/schemas/Instance/properties/protect'
                sleep_prec:
                  $ref: '#/components/schemas/Instance/properties/sleep_prec'
                dsc:
                  $ref: '#/components/schemas/Instance/properties/ins_usage'
                tags:
                  $ref: '#/components/schemas/Instance/properties/tags'
                parameters:
                  type: array
                  description: 专家模式参数设置
                  items:
                    type: object
                module:
                  type: integer
                  example: 0
                  description: 部署方式
      responses:
        200:
          description: ''
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    $ref: '#/components/schemas/Instance/properties/ok'
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/InstallTaskBody'
                  group_id:
                    $ref: '#/components/schemas/Instance/properties/group_id'
                  RequestId:
                      $ref: '#/components/schemas/Instance/properties/RequestId'
        500:
          description: ''
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    $ref: '#/components/schemas/Instance/properties/ok'
                  message:
                    type: string
                    example: message exception.
                  RequestId:
                    $ref: '#/components/schemas/Instance/properties/RequestId'
  /restore/rds:
    post:
      tags:
        - restore
      description: 通过备份文件进行数据恢复
      summary: mysql restore by backup file.
      requestBody:
        description: ''
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                backupid:
                  $ref: '#/components/schemas/BackupSetting/properties/id'
                action:
                  type: string
                  example: restore
                  description: 操作类型
                int_num:
                  type: integer
                  example: 1
                  description: 创建实例数量
                host_type:
                  $ref: '#/components/schemas/BackupSetting/properties/hosttype'
                dbtype:
                  $ref: '#/components/schemas/Instance/properties/dbtype'
                master_ip:
                  $ref: '#/components/schemas/Instance/properties/ip'
                master_port:
                  $ref: '#/components/schemas/Instance/properties/port'
                slave_ip:
                  $ref: '#/components/schemas/Instance/properties/ip'
                slave_port:
                  $ref: '#/components/schemas/Instance/properties/port'
                zone:
                  $ref: '#/components/schemas/BackupRecord/properties/zone'
                roletype:
                  $ref: '#/components/schemas/Instance/properties/role'
                version:
                  $ref: '#/components/schemas/Instance/properties/version'
                nettype:
                  type: integer
                  example: 1
                  description: 网络类型
                vpc:
                  type: string
                  example: vpc-xfdfd
                  description: vpc描述
                subnet:
                  type: string
                  example: 10.59.10.0/24
                  description: 用户网段子网
                subnetRef:
                  type: string
                  format: uuid
                  example: 529c59f2-b29f-4c66-813a-76195bdd6893
                  description: 用户子网uuid
                style:
                  type: string
                  example: style
                  description: 规格
                flavorRef:
                  type: string
                  format: uuid
                  example: 529c59f2-b29f-4c66-813a-76195bdd6893
                  description: 规格uuid
                stroage:
                  type: integer
                  example: 50
                  description: 磁盘大小,单位GB
                strotype:
                  type: integer
                  example: 10
                  description: 磁盘类型
                user:
                  type: string
                  example: root
                  description: 用户名
                password:
                  type: string
                  example: password
                  description: 密码
                backup_flag:
                  $ref: '#/components/schemas/Instance/properties/backup_flag'
                slow_flag:
                  $ref: '#/components/schemas/Instance/properties/slow_flag'
                injection_flag:
                  $ref: '#/components/schemas/Instance/properties/injection_flag'
                protect:
                  $ref: '#/components/schemas/Instance/properties/protect'
                sleep_prec:
                  $ref: '#/components/schemas/Instance/properties/sleep_prec'
                dsc:
                  $ref: '#/components/schemas/Instance/properties/ins_usage'
                tags:
                  $ref: '#/components/schemas/Instance/properties/tags'
                parameters:
                  type: array
                  description: 专家模式参数设置
                  items:
                    type: object
                module:
                  type: integer
                  example: 0
                  description: 专家模式
                group_id:
                  $ref: '#/components/schemas/Instance/properties/group_id'
                isbinlog:
                  type: integer
                  example: 0
                  description: 是否基于点时间恢复 0否 1是
                point_time:
                  type: string
                  format: date-time
                  example: "2018-02-13T02:28:28+00:00"
                  description: 基于点时间恢复的时间
      responses:
        200:
          description: ''
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    $ref: '#/components/schemas/Instance/properties/ok'
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/InstallTaskBody'
                  group_id:
                    $ref: '#/components/schemas/Instance/properties/group_id'
                  RequestId:
                    $ref: '#/components/schemas/Instance/properties/RequestId'
        500:
          description: ''
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    $ref: '#/components/schemas/Instance/properties/ok'
                  message:
                    type: string
                    example: message exception.
                  RequestId:
                    $ref: '#/components/schemas/Instance/properties/RequestId'

  /instag/ins/{ins}:
    get:
      tags: [标签管理]
      summary:   query  tag in  instance
      description:  查询实例绑定的标签信息
      parameters:
        - name: ins
          in: path
          required: true
          description: 实例ID
          example: 612252e2-de48-4d59-8721-dfe112fdaeaa
          schema:
            type: string
      responses:
        '200':
          description: 请求成功返回
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    description: 成功标志
                    example: True
                  data:
                    type: array
                    description: 标签信息
                    items:
                      $ref: '#/components/schemas/tagins'
    post:
      tags: [标签管理]
      summary:   instance add tag
      description: 绑定实例标签
      parameters:
        - name: ins
          in: path
          required: true
          description: 实例ID
          example: 612252e2-de48-4d59-8721-dfe112fdaeaa
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                opt_type:
                  type: integer
                  example: 1
                  description: >
                    操作类型：
                    * 1 - 插入绑定
                    * 2 - 合并绑定

                key_value:
                  type: array
                  example: ["tag-xk2zbgt0"]
                  description: 标签值，可多个
                  items:
                    type: string
                new_key:
                  type: array
                  example: tag-xk2zbgt2
                  description:  多个标签下的实例合并到新的标签下 ops_type=2时必填，ops_type=1 可不传
      responses:
        '200':
          description: 请求成功返回
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    description: 成功标志
                    example: True
    put:
      tags: [标签管理]
      summary:   instance update tag
      description: 修改实例标签
      parameters:
        - name: ins
          in: path
          required: true
          description: 实例ID
          example: 612252e2-de48-4d59-8721-dfe112fdaeaa
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                new_key:
                  type: string
                  example: tag-xk2zbgt2
                  description: 新标签值
                key_value:
                  type: string
                  example: ["tag-xk2zbgt0"]
                  description: 旧标签值
      responses:
        '200':
          description: 请求成功返回
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    description: 成功标志
                    example: True
    delete:
      tags: [标签管理]
      summary:   instance delete all tag
      description:  删除实例所有标签
      parameters:
        - name: ins
          in: path
          required: true
          description: 实例ID
          example: 612252e2-de48-4d59-8721-dfe112fdaeaa
          schema:
            type: string
      responses:
        '200':
          description: 请求成功返回
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    description: 成功标志
                    example: True

  /instag/ins/{ins}/tag/{tag}:
    get:
      tags: [标签管理]
      summary:   query  instance in  tag
      description:  查询实例下某个标签信息
      parameters:
        - name: ins
          in: path
          required: true
          description: 实例ID
          example: 4959f342-73e2-4c88-aabc-664c7b70e988
          schema:
            type: string
        - name: tag
          in: path
          required: true
          description: 标签值
          example: tag-ipnwi4az
          schema:
            type: string
      responses:
        '200':
          description: 请求成功返回
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    description: 成功标志
                    example: True
                  data:
                    type: array
                    description: 标签信息
                    items:
                      $ref: '#/components/schemas/tagins'
    delete:
      tags: [标签管理]
      summary:   instance delete  one tag
      description: 实例解除某个标签的绑定
      parameters:
        - name: ins
          in: path
          required: true
          description: 实例ID
          example: 612252e2-de48-4d59-8721-dfe112fdaeaa
          schema:
            type: string
        - name: tag
          in: path
          required: true
          description: 标签ID
          example: tag-xk2zbgt0
          schema:
            type: string

      responses:
        '200':
          description: 请求成功返回
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    description: 成功标志
                    example: True
  /instag/tag/{tag}:
    get:
      tags: [标签管理]
      summary:   query  instance in  tag
      description:  查询标签下所有实例
      parameters:
        - name: tag
          in: path
          required: true
          description: 标签值
          example: tag-ipnwi4az
          schema:
            type: string
      responses:
        '200':
          description: 请求成功返回
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    description: 成功标志
                    example: True
                  data:
                    type: array
                    description: 标签信息
                    items:
                      $ref: '#/components/schemas/tagins'
    delete:
      tags: [标签管理]
      summary:  delete all instance in tag
      description: 解绑某个标签下的所有实例
      parameters:
        - name: tag
          in: path
          required: true
          description: 标签ID
          example: tag-xk2zbgt0
          schema:
            type: string

      responses:
        '200':
          description: 请求成功返回
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    description: 成功标志
                    example: True
  /instag/tag/{tag}/dbtype/{dbtype}:
    get:
      tags: [标签管理]
      summary:   query  instance in  tag
      description:  查询标签下某种数据库类型的所有实例
      parameters:
        - name: tag
          in: path
          required: true
          description: 标签值
          example: tag-ipnwi4az
          schema:
            type: string
        - name: dbtype
          in: path
          required: true
          description: 数据库类型
          example: mysql
          schema:
            type: string
      responses:
        '200':
          description: 请求成功返回
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    description: 成功标志
                    example: True
                  data:
                    type: array
                    description: 标签信息
                    items:
                      $ref: '#/components/schemas/tagins'
    delete:
      tags: [标签管理]
      summary:  delete all instance in tag
      description: 解绑某个标签下某种数据库类型的的所有实例
      parameters:
        - name: tag
          in: path
          required: true
          description: 标签ID
          example: tag-xk2zbgt0
          schema:
            type: string
        - name: dbtype
          in: path
          required: true
          description:  >
            数据库类型：
            * mysql
            * mongodb
            * redis
          example: mysql
          schema:
            type: string

      responses:
        '200':
          description: 请求成功返回
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    description: 成功标志
                    example: True


  /cluster/server/{int_id}:
    post:
      tags: [高可用相关]
      summary: Manually add a standby node
      description: 增加MySQL/Redis备主节点
      parameters:
        - name: int_id
          in: path
          required: true
          description: 实例ID
          example: 612252e2-de48-4d59-8721-dfe112fdaeaa
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                ops_type:
                  type: integer
                  example: 2
                  description: 手动添加标志
                
      responses:
        '202':
          description: Created
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    description: 成功标志
                    example: True
                  data:
                    type: array
                    items:
                      type: object
                      properties:
                        disk_task:
                          type: string
                          description: iaas 创建硬盘任务ID
                          example: 3cabf143-5096-481f-9cf9-cc741c23166d
                        flag:
                          type: integer
                          description: >
                            iaas服务申请完成标志
                            * 0 - 成功完成
                            * 11 - 云主机服务申请失败
                            * 21 - 网卡服务申请失败
                            * 31 - 云硬盘服务申请失败
                          example: 0
                        host_ip:
                          type: string
                          description: 云主机管理段IP
                          example: 172.18.2.219
                        host_task:
                          type: string
                          description: iaas 创建云主机任务ID
                          example: 53cf14f6-7b71-44e8-b315-bce12a415371
                        host_uuid:
                          type: string
                          description: 云主机uuid
                          example: cc2c0625-2ae1-41fc-b87d-80b495571962
                        int_id:
                          type: string
                          description: db实例ID
                          example: bf7168b6-8b98-4dda-89e6-98db74fff339
                        message:
                          type: string
                          description: 服务申请状态描述
                          example: server deployment, please wait patiently
                        net_task:
                          type: string
                          description: iaas 创建网卡任务ID
                          example: cbf9b357-01ae-4508-9b58-144a621b6491
                        role:
                          type: integer
                          example: 42
                          description: >
                            角色类型:
                            * 42 - 备主节点
                        service_ip:
                          type: string
                          description: 用户段IP
                          example: 10.5.216.164
                  group_id:
                    type: string
                    example: 8vi356hj
                    description: 组ID
    put:
      tags: [高可用相关]
      summary: Add a readonly node
      description: 添加MySQL/Redis只读节点
      parameters:
        - name: int_id
          in: path
          required: true
          description: 实例ID
          example: 612252e2-de48-4d59-8721-dfe112fdaeaa
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                host_type:
                  type: integer
                  example: 1
                  description: >
                    主机类型:
                    * 1-虚拟机
                    * 2-物理机
                zone:
                  type: string
                  example: a
                  description: 可用区
                version:
                  type: string
                  example: 5.7
                  description: >
                    数据库版本:
                    * mysql - 5.6,5.7
                    * redis -  2.8
                nettype:
                  type: integer
                  example: 1
                  description: >
                    网络类型:
                    * 1 - 专有网络
                    * 2 - 经典网络
                vpc:
                  type: string
                  example: vpc-02c270dc 10.59.0.0/16 仓科内网
                  description: VPC描述说明
                subnet:
                  type: string
                  example: 10.5.217.0/24
                  description: 用户网段
                subnetRef:
                  type: string
                  example: e0e661c6-ab9f-42eb-b320-e660423487cc
                  description: 用户网段UUID
                style:
                  type: string
                  example: ""
                  description: 规格描述说明
                flavorRef:
                  type: string
                  example: rds.mysql.tiny
                  description: 规格编码
                stroage:
                  type: string
                  example: 50
                  description: 硬盘容量
                strotype:
                  type: string
                  example: 11
                  description: >
                    存储类型 :
                    * 10 - 容量本地
                    * 11 - 容量云盘
                    * 20 - 性能本地
                    * 21 - 性能云盘
      responses:
        '202':
          description: Created
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    description: 成功标志
                    example: True
                  data:
                    type: array
                    items:
                      type: object
                      properties:
                        disk_task:
                          type: string
                          description: iaas 创建硬盘任务ID
                          example: 3cabf143-5096-481f-9cf9-cc741c23166d
                        flag:
                          type: integer
                          description: >
                            iaas服务申请完成标志
                            * 0 - 成功完成
                            * 11 - 云主机服务申请失败
                            * 21 - 网卡服务申请失败
                            * 31 - 云硬盘服务申请失败
                          example: 0
                        host_ip:
                          type: string
                          description: 云主机管理段IP
                          example: 172.18.2.219
                        host_task:
                          type: string
                          description: iaas 创建云主机任务ID
                          example: 53cf14f6-7b71-44e8-b315-bce12a415371
                        host_uuid:
                          type: string
                          description: 云主机uuid
                          example: cc2c0625-2ae1-41fc-b87d-80b495571962
                        int_id:
                          type: string
                          description: db实例ID
                          example: bf7168b6-8b98-4dda-89e6-98db74fff339
                        message:
                          type: string
                          description: 服务申请状态描述
                          example: server deployment, please wait patiently
                        net_task:
                          type: string
                          description: iaas 创建网卡任务ID
                          example: cbf9b357-01ae-4508-9b58-144a621b6491
                        role:
                          type: integer
                          example: 43
                          description: >
                            角色类型:
                            * 42 - 备主节点
                        service_ip:
                          type: string
                          description: 用户段IP
                          example: 10.5.216.164
                  group_id:
                    type: string
                    example: 8vi356hj
                    description: 组ID
  /clusterinfo/{int_id}:
    get:
      tags: [高可用相关]
      summary:   cluster log
      description: 查询集群的异常日志
      parameters:
        - name: int_id
          in: path
          required: true
          description: 实例ID
          example: 612252e2-de48-4d59-8721-dfe112fdaeaa
          schema:
            type: string
      responses:
        '200':
          description: 请求成功返回
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    description: 成功标志
                    example: True
                  data:
                    type: array
                    description: 数据返回
                    items:
                      type: object
                      properties:
                        id:
                          type: integer
                          description: 行ID
                          example:
                        int_id:
                          type: string
                          description: 实例ID
                          example: c0768892-1d4e-44d3-9d6f-7a0ff16bf034
                        group_id:
                          type: string
                          description: 组Id
                          example: f47bkqy1
                        log_type:
                          type: string
                          description: >
                              * - WARNING
                              * - INFO
                              * - ERROR
                          example: ERROR
                        log_time:
                          type: string
                          description: 开始时间
                          example: "2018-06-08:10:20:20"
                        uuid:
                          type: string
                          description: 主机uuid
                          example: b7e25119-0ff8-4f1a-8531-d0f2397210fd
                        port:
                          type: string
                          description: 端口
                          example: 3306
  /mongo/shard:
    post:
      tags: [MongoDB - Shard相关]
      summary: create shard
      description: MongoDB - Shard部署
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                int_num:
                  type: integer
                  example: 1
                  description: 申请实例组数
                host_type:
                  type: integer
                  example: 1
                  description: >
                    主机类型:
                    * 1-虚拟机
                    * 2-物理机
                dbtype:
                  type: string
                  example: mongodb
                  description: >
                    数据库类型:
                    * - mongodb
                roletype:
                  type: integer
                  example: 5
                  description: >
                    部署类型:
                    * - Shard
                zone:
                  type: string
                  example: a
                  description: 可用区
                version:
                  type: string
                  example: 3.6
                  description: >
                    数据库版本:
                    * mongodb - 3.2,3.6
                nettype:
                  type: integer
                  example: 1
                  description: >
                    网络类型:
                    * 1 - 专有网络
                    * 2 - 经典网络
                vpc:
                  type: string
                  example: vpc-02c270dc 10.59.0.0/16 仓科内网
                  description: VPC描述说明
                subnet:
                  type: string
                  example: 10.5.217.0/24
                  description: 用户网段
                subnetRef:
                  type: string
                  example: e0e661c6-ab9f-42eb-b320-e660423487cc
                  description: 用户网段UUID
                style:
                  type: string
                  example: ""
                  description: 规格描述说明
                flavorRef:
                  type: string
                  example: rds.mysql.tiny
                  description: 规格编码
                stroage:
                  type: string
                  example: 50
                  description: 硬盘容量
                strotype:
                  type: string
                  example: 11
                  description: >
                    存储类型 :
                    * 10 - 容量本地
                    * 11 - 容量云盘
                    * 20 - 性能本地
                    * 21 - 性能云盘
                dsc:
                  type: string
                  example: mongo shard
                  description:  描述
                
      responses:
        '202':
          description: Created
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    description: 成功标志
                    example: True
                  group_id:
                    type: string
                    example: 8vi356hj
                    description: 组ID
                  req_id:
                    type: string
                    example: 53cf14f6-7b71-44e8-b315-bce12a415371
                    description: 请求ID
                  data:
                    type: object
                    properties:
                      mongos_server:
                        type: array
                        items:
                          type: object
                          properties:
                            disk_task:
                              type: string
                              description: iaas 创建硬盘任务ID
                              example: 3cabf143-5096-481f-9cf9-cc741c23166d
                            role_flag:
                              type: integer
                              example: 1
                              description: 标志服务器顺序
                            host_ip:
                              type: string
                              description: 云主机管理段IP
                              example: 172.18.2.219
                            host_port:
                              type: string
                              description: 云主机管理端口
                              example: 30000
                            host_task:
                              type: string
                              description: iaas 创建云主机任务ID
                              example: 53cf14f6-7b71-44e8-b315-bce12a415371
                            host_uuid:
                              type: string
                              description: 云主机uuid
                              example: cc2c0625-2ae1-41fc-b87d-80b495571962
                            int_id:
                              type: string
                              description: db实例ID
                              example: bf7168b6-8b98-4dda-89e6-98db74fff339
                            net_task:
                              type: string
                              description: iaas 创建网卡任务ID
                              example: cbf9b357-01ae-4508-9b58-144a621b6491
                            role:
                              type: integer
                              example: 5
                              description: >
                                角色类型:
                                  * 5 - mongos
                            service_ip:
                              type: string
                              description: 用户段IP
                              example: 10.5.216.164
                      config_server:
                        type: array
                        items:
                          type: object
                          properties:
                            disk_task:
                              type: string
                              description: iaas 创建硬盘任务ID
                              example: 3cabf143-5096-481f-9cf9-cc741c23166d
                            role_flag:
                              type: integer
                              example: 1
                              description: 标志服务器顺序
                            host_ip:
                              type: string
                              description: 云主机管理段IP
                              example: 172.18.2.215
                            host_port:
                              type: string
                              description: 云主机管理端口
                              example: 27017
                            host_task:
                              type: string
                              description: iaas 创建云主机任务ID
                              example: 53cf14f6-7b71-44e8-b315-bce12a415371
                            host_uuid:
                              type: string
                              description: 云主机uuid
                              example: cc2c0625-2ae1-41fc-b87d-80b495571962
                            int_id:
                              type: string
                              description: db实例ID
                              example: bf7168b6-8b98-4dda-89e6-98db74fff339
                            net_task:
                              type: string
                              description: iaas 创建网卡任务ID
                              example: cbf9b357-01ae-4508-9b58-144a621b6491
                            role:
                              type: integer
                              example: 6
                              description: >
                                角色类型:
                                  * 6 - config
                            service_ip:
                              type: string
                              description: 用户段IP
                              example: 10.5.216.165
                      shard_server_1:
                        type: array
                        items:
                          type: object
                          properties:
                            disk_task:
                              type: string
                              description: iaas 创建硬盘任务ID
                              example: 3cabf143-5096-481f-9cf9-cc741c23166d
                            role_flag:
                              type: integer
                              example: 1
                              description: 标志服务器顺序
                            host_ip:
                              type: string
                              description: 云主机管理段IP
                              example: 172.18.2.214
                            host_port:
                              type: string
                              description: 云主机管理端口
                              example: 27017
                            host_task:
                              type: string
                              description: iaas 创建云主机任务ID
                              example: 53cf14f6-7b71-44e8-b315-bce12a415371
                            host_uuid:
                              type: string
                              description: 云主机uuid
                              example: cc2c0625-2ae1-41fc-b87d-80b495571962
                            int_id:
                              type: string
                              description: db实例ID
                              example: bf7168b6-8b98-4dda-89e6-98db74fff339
                            net_task:
                              type: string
                              description: iaas 创建网卡任务ID
                              example: cbf9b357-01ae-4508-9b58-144a621b6491
                            role:
                              type: integer
                              example: 7
                              description: >
                                角色类型:
                                  * 7 - shard
                            service_ip:
                              type: string
                              description: 用户段IP
                              example: 10.5.216.166
                      shard_server_2:
                        type: array
                        items:
                          type: object
                          properties:
                            disk_task:
                              type: string
                              description: iaas 创建硬盘任务ID
                              example: 3cabf143-5096-481f-9cf9-cc741c23166d
                            role_flag:
                              type: integer
                              example: 1
                              description: 标志服务器顺序
                            host_ip:
                              type: string
                              description: 云主机管理段IP
                              example: 172.18.2.213
                            host_port:
                              type: string
                              description: 云主机管理端口
                              example: 27017
                            host_task:
                              type: string
                              description: iaas 创建云主机任务ID
                              example: 53cf14f6-7b71-44e8-b315-bce12a415371
                            host_uuid:
                              type: string
                              description: 云主机uuid
                              example: cc2c0625-2ae1-41fc-b87d-80b495571962
                            int_id:
                              type: string
                              description: db实例ID
                              example: bf7168b6-8b98-4dda-89e6-98db74fff339
                            net_task:
                              type: string
                              description: iaas 创建网卡任务ID
                              example: cbf9b357-01ae-4508-9b58-144a621b6491
                            role:
                              type: integer
                              example: 7
                              description: >
                                角色类型:
                                  * 7 - shard
                            service_ip:
                              type: string
                              description: 用户段IP
                              example: 10.5.216.164

  /mongo/shard/{int_id}:
    put:
      tags: [MongoDB -Shard相关]
      summary: Add a shard node
      description: 增加MongoDB-Shard节点
      parameters:
        - name: int_id
          in: path
          required: true
          description: 实例ID
          example: 612252e2-de48-4d59-8721-dfe112fdaeaa
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                int_num:
                  type: integer
                  example: 1
                  description: 申请实例组数
                host_type:
                  type: integer
                  example: 1
                  description: >
                    主机类型:
                    * 1-虚拟机
                    * 2-物理机
                dbtype:
                  type: string
                  example: mongodb
                  description: >
                    数据库类型:
                    * - mongodb
                roletype:
                  type: integer
                  example: 5
                  description: >
                    部署类型:
                    * - Shard
                zone:
                  type: string
                  example: a
                  description: 可用区
                version:
                  type: string
                  example: 3.6
                  description: >
                    数据库版本:
                    * mongodb - 3.2,3.6
                nettype:
                  type: integer
                  example: 1
                  description: >
                    网络类型:
                    * 1 - 专有网络
                    * 2 - 经典网络
                vpc:
                  type: string
                  example: vpc-02c270dc 10.59.0.0/16 仓科内网
                  description: VPC描述说明
                subnet:
                  type: string
                  example: 10.5.217.0/24
                  description: 用户网段
                subnetRef:
                  type: string
                  example: e0e661c6-ab9f-42eb-b320-e660423487cc
                  description: 用户网段UUID
                style:
                  type: string
                  example: ""
                  description: 规格描述说明
                flavorRef:
                  type: string
                  example: rds.mysql.tiny
                  description: 规格编码
                stroage:
                  type: string
                  example: 50
                  description: 硬盘容量
                strotype:
                  type: string
                  example: 11
                  description: >
                    存储类型 :
                    * 10 - 容量本地
                    * 11 - 容量云盘
                    * 20 - 性能本地
                    * 21 - 性能云盘
                dsc:
                  type: string
                  example: mongo shard
                  description:  描述
      responses:
        '202':
          description: Created
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    description: 成功标志
                    example: True
                  req_id:
                    type: string
                    example: 53cf14f6-7b71-44e8-b315-bce12a415371
                    description: 请求ID
                  data:
                    type: array
                    items:
                      type: object
                      properties:
                        disk_task:
                          type: string
                          description: iaas 创建硬盘任务ID
                          example: 3cabf143-5096-481f-9cf9-cc741c23166d
                        flag:
                          type: integer
                          description: >
                            iaas服务申请完成标志
                            * 0 - 成功完成
                            * 11 - 云主机服务申请失败
                            * 21 - 网卡服务申请失败
                            * 31 - 云硬盘服务申请失败
                          example: 0
                        host_ip:
                          type: string
                          description: 云主机管理段IP
                          example: 172.18.2.219
                        host_task:
                          type: string
                          description: iaas 创建云主机任务ID
                          example: 53cf14f6-7b71-44e8-b315-bce12a415371
                        host_uuid:
                          type: string
                          description: 云主机uuid
                          example: cc2c0625-2ae1-41fc-b87d-80b495571962
                        int_id:
                          type: string
                          description: db实例ID
                          example: bf7168b6-8b98-4dda-89e6-98db74fff339
                        message:
                          type: string
                          description: 服务申请状态描述
                          example: server deployment, please wait patiently
                        net_task:
                          type: string
                          description: iaas 创建网卡任务ID
                          example: cbf9b357-01ae-4508-9b58-144a621b6491
                        role:
                          type: integer
                          example: 7
                          description: >
                            角色类型:
                            * 7- shard
                        service_ip:
                          type: string
                          description: 用户段IP
                          example: 10.5.216.164
                  group_id:
                    type: string
                    example: 8vi356hj
                    description: 组ID
  /replnode:
    post:
      tags: [MongoDB - ReplicaSet相关]
      summary: mongodb replset add node
      description: 新增replica set节点
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                group_id:
                  type: string
                  example: qxnhtwku
                  description: 组ID
                arbiterOnly:
                  type: integer
                  example: 1
                  description: >
                    节点类型：
                    * - 1 仲裁节点
                    * - 0 普通节点
                host_type:
                  type: integer
                  example: 1
                  description: >
                    主机类型:
                    * 1-虚拟机
                    * 2-物理机
                roletype:
                  type: integer
                  example: 4
                  description: >
                    部署类型:
                    * - RS
                zone:
                  type: string
                  example: a
                  description: 可用区
                version:
                  type: string
                  example: 3.6
                  description: >
                    数据库版本:
                    * mongodb - 3.2,3.6
                nettype:
                  type: integer
                  example: 1
                  description: >
                    网络类型:
                    * 1 - 专有网络
                    * 2 - 经典网络
                vpc:
                  type: string
                  example: vpc-02c270dc 10.59.0.0/16 仓科内网
                  description: VPC描述说明
                subnet:
                  type: string
                  example: 10.5.217.0/24
                  description: 用户网段
                subnetRef:
                  type: string
                  example: e0e661c6-ab9f-42eb-b320-e660423487cc
                  description: 用户网段UUID
                style:
                  type: string
                  example: ""
                  description: 规格描述说明
                flavorRef:
                  type: string
                  example: rds.mysql.tiny
                  description: 规格编码
                stroage:
                  type: string
                  example: 50
                  description: 硬盘容量
                strotype:
                  type: string
                  example: 11
                  description: >
                    存储类型 :
                    * 10 - 容量本地
                    * 11 - 容量云盘
                    * 20 - 性能本地
                    * 21 - 性能云盘
                tag:
                  type: array
                  description: 标签 默认空
                  items:
                    type: string
                dsc:
                  type: string
                  example: mongo shard
                  description:  描述
                
      responses:
        '202':
          description: Created
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    description: 成功标志
                    example: True
                  data:
                    type: array
                    items:
                      type: object
                      properties:
                        disk_task:
                          type: string
                          description: iaas 创建硬盘任务ID
                          example: 3cabf143-5096-481f-9cf9-cc741c23166d
                        flag:
                          type: integer
                          description: >
                            iaas服务申请完成标志
                            * 0 - 成功完成
                            * 11 - 云主机服务申请失败
                            * 21 - 网卡服务申请失败
                            * 31 - 云硬盘服务申请失败
                          example: 0
                        host_ip:
                          type: string
                          description: 云主机管理段IP
                          example: 172.18.2.219
                        host_task:
                          type: string
                          description: iaas 创建云主机任务ID
                          example: 53cf14f6-7b71-44e8-b315-bce12a415371
                        host_uuid:
                          type: string
                          description: 云主机uuid
                          example: cc2c0625-2ae1-41fc-b87d-80b495571962
                        int_id:
                          type: string
                          description: db实例ID
                          example: bf7168b6-8b98-4dda-89e6-98db74fff339
                        message:
                          type: string
                          description: 服务申请状态描述
                          example: server deployment, please wait patiently
                        net_task:
                          type: string
                          description: iaas 创建网卡任务ID
                          example: cbf9b357-01ae-4508-9b58-144a621b6491
                        role:
                          type: integer
                          example: 4
                          description: >
                            角色类型:
                            * 4 - RS
                        service_ip:
                          type: string
                          description: 用户段IP
                          example: 10.5.216.164
                  group_id:
                    type: string
                    example: 8vi356hj
                    description: 组ID

  /replnode/{int_id}:
    put:
      tags: [MongoDB - ReplicaSet相关]
      summary: secondary to primary
      description: 将replica set的secondary节点提升为primary节点
      parameters:
        - name: int_id
          in: path
          required: true
          description: 实例ID
          example: 612252e2-de48-4d59-8721-dfe112fdaeaa
          schema:
            type: string
      responses:
        '202':
          description: Created
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    description: 成功标志
                    example: True
                  task:
                    type: array
                    description: 任务描述
                    items:
                      type: object
                      properties:
                        id:
                          type: string
                          description: 任务ID
                          example: 4013a014-018c-44bd-848f-edda43d0409b
                        msg:
                          type: string
                          description: 任务描述
                          example: MongoDB切换成primary节点
                  RequestId:
                    type: string
                    description: 请求ID
                    example: 2013a014-018c-44bd-848f-edda43d0409
    delete:
      tags: [Mongodb 删除节点]
      summary: delete node
      parameters:
        - name: int_id
          in: path
          required: true
          description: 实例ID
          example: 612252e2-de48-4d59-8721-dfe112fdaeaa
          schema:
            type: string
      responses:
        '202':
          description: Created
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    description: 成功标志
                    example: True
                  task:
                    type: array
                    description: 任务描述
                    items:
                      type: object
                      properties:
                        id:
                          type: string
                          description: 任务ID
                          example: 4013a014-018c-44bd-848f-edda43d0409b
                        msg:
                          type: string
                          description: 任务描述
                          example: MongoDB-RS节点删除
                  RequestId:
                    type: string
                    description: 请求ID
                    example: 2013a014-018c-44bd-848f-edda43d0409

  /review/{int_id}/history:
    get:
      tags:
        - sqlreview
      description: 返回SQL审核记录列表
      summary: Return all sqlreview records by insid.
      parameters:
        - $ref: '#/components/parameters/IntIDInPath'
      responses:
        '200':
          description: A list of sqlreview records by int_id.
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    $ref: '#/components/schemas/Instance/properties/ok'
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/SQLReviewRecord'
                  RequestId:
                    $ref: '#/components/schemas/Instance/properties/RequestId'
    post:
      tags:
        - sqlreview
      description: 新增SQL审核记录
      parameters:
        - $ref: '#/components/parameters/IntIDInPath'
      requestBody:
        description: ''
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                db:
                  $ref: '#/components/schemas/SQLReviewRecord/properties/db'
                content:
                  $ref: '#/components/schemas/SQLReviewRecord/properties/content'
      responses:
        200:
          description: ''
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    $ref: '#/components/schemas/Instance/properties/ok'
                  data:
                    $ref: '#/components/schemas/BackupRecord'
                  RequestId:
                      $ref: '#/components/schemas/Instance/properties/RequestId'
        500:
          description: ''
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    $ref: '#/components/schemas/Instance/properties/ok'
                  message:
                    type: string
                    example: message exception.
                  RequestId:
                    $ref: '#/components/schemas/Instance/properties/RequestId'

  /review/{int_id}/history{rewid}:
    put:
      tags:
        - sqlreview
      description: 更新SQL审核记录
      parameters:
        - $ref: '#/components/parameters/IntIDInPath'
        - $ref: '#/components/parameters/RewIDInPath'
      requestBody:
        description: ''
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                status:
                  $ref: '#/components/schemas/SQLReviewRecord/properties/status'
      responses:
        200:
          description: ''
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    $ref: '#/components/schemas/Instance/properties/ok'
                  data:
                    $ref: '#/components/schemas/BackupRecord'
                  RequestId:
                      $ref: '#/components/schemas/Instance/properties/RequestId'
        500:
          description: ''
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    $ref: '#/components/schemas/Instance/properties/ok'
                  message:
                    type: string
                    example: message exception.
                  RequestId:
                    $ref: '#/components/schemas/Instance/properties/RequestId'

  /review/{int_id}/action:
      post:
        tags:
          - sqlreview
        description: 审核/执行SQL记录
        parameters:
          - $ref: '#/components/parameters/IntIDInPath'
        requestBody:
          description: ''
          required: true
          content:
            application/json:
              schema:
                type: object
                properties:
                  action:
                    $ref: '#/components/schemas/OtherBody/properties/action'
                  insid:
                    $ref: '#/components/schemas/Instance/properties/int_id'
                  rewid:
                    $ref: '#/components/schemas/SQLReviewRecord/properties/rewid'
        responses:
          202:
            description: ''
            content:
              application/json:
                schema:
                  type: object
                  properties:
                    ok:
                      $ref: '#/components/schemas/Instance/properties/ok'
                    task:
                      type: array
                      items:
                        $ref: '#/components/schemas/AsyncTaskBody'
                    rewid:
                      $ref: '#/components/schemas/SQLReviewRecord/properties/rewid'
                    RequestId:
                        $ref: '#/components/schemas/Instance/properties/RequestId'
          500:
            description: ''
            content:
              application/json:
                schema:
                  type: object
                  properties:
                    ok:
                      $ref: '#/components/schemas/Instance/properties/ok'
                    message:
                      type: string
                      example: message exception.
                    RequestId:
                      $ref: '#/components/schemas/Instance/properties/RequestId'

  /review/{rewid}/result:
    get:
      tags:
        - sqlreview
      description: 返回SQL审核记录列表
      summary: Return all sqlreview result records by rewid.
      parameters:
        - $ref: '#/components/parameters/RewIDInPath'
      responses:
        '200':
          description: A list of sqlreview records by rewid.
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    $ref: '#/components/schemas/Instance/properties/ok'
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/SQLReviewResult'
                  RequestId:
                    $ref: '#/components/schemas/Instance/properties/RequestId'
    post:
      tags:
        - sqlreview
      description: 新增SQL审核结果
      parameters:
        - $ref: '#/components/parameters/RewIDInPath'
      requestBody:
        description: ''
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                insid:
                  $ref: '#/components/schemas/Instance/properties/int_id'
                rewid:
                  $ref: '#/components/schemas/SQLReviewRecord/properties/rewid'
                id:
                  $ref: '#/components/schemas/Instance/properties/id'
                stage:
                  $ref: '#/components/schemas/SQLReviewResult/properties/stage'
                errlevel:
                  $ref: '#/components/schemas/SQLReviewResult/properties/errlevel'
                stagestatus:
                  $ref: '#/components/schemas/SQLReviewResult/properties/stagestatus'
                errormessage:
                  $ref: '#/components/schemas/SQLReviewResult/properties/errormessage'
                sql:
                  $ref: '#/components/schemas/SQLReviewResult/properties/sql'
                affected_rows:
                  $ref: '#/components/schemas/SQLReviewResult/properties/affected_rows'
                backup_dbname:
                  $ref: '#/components/schemas/SQLReviewResult/properties/db'
                execute_time:
                  $ref: '#/components/schemas/SQLReviewResult/properties/execute_time'
                sqlsha1:
                  $ref: '#/components/schemas/SQLReviewResult/properties/sqlhash'
                rollbacked_at:
                  $ref: '#/components/schemas/SQLReviewResult/properties/rollbacked_at'
                is_rollback:
                  $ref: '#/components/schemas/SQLReviewResult/properties/is_rollback'
                rollbacked:
                  $ref: '#/components/schemas/SQLReviewResult/properties/rollbacked'
      responses:
        200:
          description: ''
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    $ref: '#/components/schemas/Instance/properties/ok'
                  data:
                    $ref: '#/components/schemas/SQLReviewResult'
                  RequestId:
                      $ref: '#/components/schemas/Instance/properties/RequestId'
        500:
          description: ''
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    $ref: '#/components/schemas/Instance/properties/ok'
                  message:
                    type: string
                    example: message exception.
                  RequestId:
                    $ref: '#/components/schemas/Instance/properties/RequestId'
    put:
        tags:
          - sqlreview
        description: 回滚SQL记录
        parameters:
          - $ref: '#/components/parameters/RewIDInPath'
        requestBody:
          description: ''
          required: true
          content:
            application/json:
              schema:
                type: object
                properties:
                  sequence:
                    $ref: '#/components/schemas/SQLReviewResult/properties/sequence'
                  insid:
                    $ref: '#/components/schemas/Instance/properties/int_id'
                  backup_dbname:
                    $ref: '#/components/schemas/SQLReviewResult/properties/db'
        responses:
          200:
            description: ''
            content:
              application/json:
                schema:
                  type: object
                  properties:
                    ok:
                      $ref: '#/components/schemas/Instance/properties/ok'
                    task:
                      type: array
                      items:
                        $ref: '#/components/schemas/AsyncTaskBody'
                    rewid:
                      $ref: '#/components/schemas/SQLReviewRecord/properties/rewid'
                    RequestId:
                        $ref: '#/components/schemas/Instance/properties/RequestId'
          500:
            description: ''
            content:
              application/json:
                schema:
                  type: object
                  properties:
                    ok:
                      $ref: '#/components/schemas/Instance/properties/ok'
                    message:
                      type: string
                      example: message exception.
                    RequestId:
                      $ref: '#/components/schemas/Instance/properties/RequestId'

  /dict_tab:
    post:
      tags: [可用区管理]
      summary:  get style flavor info
      description: 根据数据库类型获取规格信息
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                zone:
                  type: string
                  example: a
                  description: 可用区
                dbtype:
                  type: string
                  example: mysql
                  description: >
                    数据库类型：
                    * mysql
                    * mongodb
                    * redis


      responses:
        '200':
          description: 请求成功返回
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    description: 成功标志
                    example: True
                  data:
                    type: array
                    description: 规格信息详情
                    items:
                      type: object
                      properties:
                        comment:
                          type: string
                          description: 规格描述
                          example: 1核 1GB
                        key_name:
                          type: string
                          description: dbaas平台规格编码
                          example: rds.mysql.tiny
                        key_value:
                          type: string
                          description: iaas规格编码
                          example: ecs.n1.tiny
                        pname:
                          type: string
                          description: 字典类型
                          example: style
  /dict_tab/{pname}/zone/{zone}:
    post:
      tags: [可用区管理]
      summary:  get parameter from dbaas
      description: dbaas平台参数配置情况
      parameters:
        - name: pname
          in: path
          required: true
          description: >
            参数类型：
            * backup - 备份方式
            * style - 规格
            * module - 部署模式
            * zone  -  可用区
            * version - 版本
            * roletype - 角色类型
            * nettype - 网络类型
          example: style
          schema:
            type: string
        - name: zone
          in: path
          required: true
          description: 可用区
          schema:
            type: string


      responses:
        '200':
          description: 请求成功返回
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    description: 成功标志
                    example: True
                  data:
                    type: array
                    description: 规格信息详情
                    items:
                      type: object
                      properties:
                        comment:
                          type: string
                          description: 参数类型说明
                          example: 1核 1GB
                        key_name:
                          type: string
                          description: 参数名称
                          example: rds.mysql.tiny
                        key_value:
                          type: string
                          description: 参数值
                          example: ecs.n1.tiny
                        pname:
                          type: string
                          description: 参数类型
                          example: style
                        local_zone:
                          type: string
                          description: 所属可用区
                          example: a

  /zone/globalview/{zone_id}:
    get:
      tags: [可用区管理]
      summary:   zone view
      description: 可用区面板全局参数展示
      parameters:
        - name: zone_id
          in: path
          required: true
          description: 可用区行ID
          example: 1
          schema:
            type: integer
      responses:
        '200':
          description: 请求成功返回
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    description: 成功标志
                    example: True
                  data:
                    type: object
                    description: 数据返回
                    properties:
                      public_dict:
                        type: object
                        description: 公共参数字典
                        properties:
                          backup:
                            type: array
                            description: 备份参数信息
                            items:
                              type: object
                              properties:
                                id:
                                  type: integer
                                  description: 行ID
                                  example: 38
                                zone_id:
                                  type: integer
                                  description: 可用区行ID
                                  example: 1
                                zone_display:
                                  type: string
                                  description: 可用区名称
                                  example: 仓科A区
                                dict_id:
                                  type: integer
                                  description: 字典表行ID
                                  example: 38
                                dict_display:
                                  type: string
                                  description: 参数名称
                                  example: mysqldump
                                dict_value:
                                  type: string
                                  description: 参数值
                                  example: "1"
                          dbtype:
                            type: array
                            description: 数据库类型信息
                            items:
                              type: object
                              properties:
                                id:
                                  type: integer
                                  description: 行ID
                                  example: 3
                                zone_id:
                                  type: integer
                                  description: 可用区行ID
                                  example: 1
                                zone_display:
                                  type: string
                                  description: 可用区名称
                                  example: 仓科A区
                                dict_id:
                                  type: integer
                                  description: 字典表行ID
                                  example: 3
                                dict_display:
                                  type: string
                                  description: 参数名称
                                  example: MySQL
                                dict_value:
                                  type: string
                                  description: 参数值
                                  example: "1"
                          flavorRef:
                            type: array
                            description: dbaas平台规格信息
                            items:
                              type: object
                              properties:
                                id:
                                  type: integer
                                  description: 行ID
                                  example: 47
                                zone_id:
                                  type: integer
                                  description: 可用区行ID
                                  example: 1
                                zone_display:
                                  type: string
                                  description: 可用区名称
                                  example: 仓科A区
                                dict_id:
                                  type: integer
                                  description: 字典表行ID
                                  example: 47
                                dict_display:
                                  type: string
                                  description: 参数名称
                                  example: 1GB
                                dict_value:
                                  type: string
                                  description: 参数值
                                  example: db.n0.tiny
                          globalcode:
                            type: array
                            description: 全局用户信息不展示
                            items:
                              type: object
                              properties:
                                id:
                                  type: integer
                                  description: 行ID
                                  example: 42
                                zone_id:
                                  type: integer
                                  description: 可用区行ID
                                  example: 1
                                zone_display:
                                  type: string
                                  description: 可用区名称
                                  example: 仓科A区
                                dict_id:
                                  type: integer
                                  description: 字典表行ID
                                  example: 42
                                dict_display:
                                  type: string
                                  description: 参数名称
                                  example: dbsys_admin
                                dict_value:
                                  type: string
                                  description: 参数值
                                  example: apb79a555d8bdfp0948d11ahk09f8a90310311f19712971a28
                          iptype:
                            type: array
                            description: IP类型
                            items:
                              type: object
                              properties:
                                id:
                                  type: integer
                                  description: 行ID
                                  example: 43
                                zone_id:
                                  type: integer
                                  description: 可用区行ID
                                  example: 1
                                zone_display:
                                  type: string
                                  description: 可用区名称
                                  example: 仓科A区
                                dict_id:
                                  type: integer
                                  description: 字典表行ID
                                  example: 43
                                dict_display:
                                  type: string
                                  description: 参数名称
                                  example: 管理网IP
                                dict_value:
                                  type: string
                                  description: 参数值
                                  example: "1"

                          module:
                            type: array
                            description: IP类型
                            items:
                              type: object
                              properties:
                                id:
                                  type: integer
                                  description: 行ID
                                  example: 1
                                zone_id:
                                  type: integer
                                  description: 可用区行ID
                                  example: 1
                                zone_display:
                                  type: string
                                  description: 可用区名称
                                  example: 仓科A区
                                dict_id:
                                  type: integer
                                  description: 字典表行ID
                                  example: 1
                                dict_display:
                                  type: string
                                  description: 参数名称
                                  example: 简单模式
                                dict_value:
                                  type: string
                                  description: 参数值
                                  example: "0"
                          remotebk:
                            type: array
                            description: IP类型
                            items:
                              type: object
                              properties:
                                id:
                                  type: integer
                                  description: 行ID
                                  example: 9
                                zone_id:
                                  type: integer
                                  description: 可用区行ID
                                  example: 1
                                zone_display:
                                  type: string
                                  description: 可用区名称
                                  example: 仓科A区
                                dict_id:
                                  type: integer
                                  description: 字典表行ID
                                  example: 9
                                dict_display:
                                  type: string
                                  description: 参数名称
                                  example: nfs
                                dict_value:
                                  type: string
                                  description: 参数值
                                  example: "1"
                          role:
                            type: array
                            description: 角色类型
                            items:
                              type: object
                              properties:
                                id:
                                  type: integer
                                  description: 行ID
                                  example: 27
                                zone_id:
                                  type: integer
                                  description: 可用区行ID
                                  example: 1
                                zone_display:
                                  type: string
                                  description: 可用区名称
                                  example: 仓科A区
                                dict_id:
                                  type: integer
                                  description: 字典表行ID
                                  example: 27
                                dict_display:
                                  type: string
                                  description: 参数名称
                                  example: 主库
                                dict_value:
                                  type: string
                                  description: 参数值
                                  example: "1" 
                          structure:
                            type: array
                            description: 数据库结构类型
                            items:
                              type: object
                              properties:
                                id:
                                  type: integer
                                  description: 行ID
                                  example: 18
                                zone_id:
                                  type: integer
                                  description: 可用区行ID
                                  example: 1
                                zone_display:
                                  type: string
                                  description: 可用区名称
                                  example: 仓科A区
                                dict_id:
                                  type: integer
                                  description: 字典表行ID
                                  example: 18
                                dict_display:
                                  type: string
                                  description: 参数名称
                                  example: MySQL-基础版
                                dict_value:
                                  type: string
                                  description: 参数值
                                  example: "3"

                          version:
                            type: array
                            description: 版本类型
                            items:
                              type: object
                              properties:
                                id:
                                  type: integer
                                  description: 行ID
                                  example: 11
                                zone_id:
                                  type: integer
                                  description: 可用区行ID
                                  example: 1
                                zone_display:
                                  type: string
                                  description: 可用区名称
                                  example: 仓科A区
                                dict_id:
                                  type: integer
                                  description: 字典表行ID
                                  example: 11
                                dict_display:
                                  type: string
                                  description: 参数名称
                                  example: MySQL-5.6
                                dict_value:
                                  type: string
                                  description: 参数值
                                  example: "5.6"
                      private_dict:
                        type: object
                        description: 私有参数字典
                        properties:
                          nettype:
                            type: array
                            description: 网络类型
                            items:
                              type: object
                              properties:
                                id:
                                  type: integer
                                  description: 行ID
                                  example: 14
                                zone_id:
                                  type: integer
                                  description: 可用区行ID
                                  example: 1
                                zone_display:
                                  type: string
                                  description: 可用区名称
                                  example: 仓科A区
                                dict_id:
                                  type: integer
                                  description: 字典表行ID
                                  example: 78
                                dict_display:
                                  type: string
                                  description: 参数名称
                                  example: 专有网络
                                dict_value:
                                  type: string
                                  description: 参数值
                                  example: "1"
                          remotebk:
                            type: array
                            description: 远程备份参数
                            items:
                              type: object
                              properties:
                                id:
                                  type: integer
                                  description: 行ID
                                  example: 3
                                zone_id:
                                  type: integer
                                  description: 可用区行ID
                                  example: 1
                                zone_display:
                                  type: string
                                  description: 可用区名称
                                  example: 仓科A区
                                dict_id:
                                  type: integer
                                  description: 字典表行ID
                                  example: 65
                                dict_display:
                                  type: string
                                  description: 参数名称
                                  example: ftp_ip
                                dict_value:
                                  type: string
                                  description: 参数值
                                  example: 10.59.115.226
                          strotype:
                            type: array
                            description: 存储类型
                            items:
                              type: object
                              properties:
                                id:
                                  type: integer
                                  description: 行ID
                                  example: 2
                                zone_id:
                                  type: integer
                                  description: 可用区行ID
                                  example: 1
                                zone_display:
                                  type: string
                                  description: 可用区名称
                                  example: 仓科A区
                                dict_id:
                                  type: integer
                                  description: 字典表行ID
                                  example: 74
                                dict_display:
                                  type: string
                                  description: 参数名称
                                  example: SAS云盘
                                dict_value:
                                  type: string
                                  description: 参数值
                                  example: "11"
                          vpc:
                            type: array
                            description: 外网类型
                            items:
                              type: object
                              properties:
                                id:
                                  type: integer
                                  description: 行ID
                                  example: 9
                                zone_id:
                                  type: integer
                                  description: 可用区行ID
                                  example: 1
                                zone_display:
                                  type: string
                                  description: 可用区名称
                                  example: 仓科A区
                                dict_id:
                                  type: integer
                                  description: 字典表行ID
                                  example: 73
                                dict_display:
                                  type: string
                                  description: 参数名称
                                  example: 外网类型
                                dict_value:
                                  type: string
                                  description: 参数值
                                  example: vsw
                      flavorRef_dict:
                        type: object
                        description: 规格参数字典
                        properties:
                          Mongodb:
                            type: array
                            description: mongodb
                            items:
                              type: object
                              properties:
                                id:
                                  type: integer
                                  description: 行ID
                                  example: 14
                                zone_id:
                                  type: integer
                                  description: 可用区行ID
                                  example: 1
                                zone_display:
                                  type: string
                                  description: 可用区名称
                                  example: 仓科A区
                                dbtype:
                                  type: string
                                  description:  数据库标识
                                  example: "3"
                                dbtype_display:
                                  type: string
                                  description: 参数名称
                                  example: Mongodb
                                flavorRef_id:
                                  type: integer
                                  description:  规格字典ID
                                  example: 55
                                flavorRef_display:
                                  type: string
                                  description:  规格名称
                                  example: 1核 2GB
                                flavorRef_iaas:
                                  type: string
                                  description:  对应iaas平台规格值
                                  example: ecs.n1.small
                                iaas_flavname:
                                  type: string
                                  description:  对应iaas平台规格名称，填空
                                  example: ''
                                iobyte:
                                  type: integer
                                  description:  iobyte（io读写mysql，mongodb类型需设置）
                                  example: 104857600
                                iops:
                                  type: integer
                                  description:  iops（io读写mysql，mongodb类型需设置）
                                  example: 1000
                                bwin:
                                  type: integer
                                  description:  bwin
                                  example: 0
                                bwout:
                                  type: integer
                                  description:  bwout
                                  example: 0
                          MySQL:
                            type: array
                            description: mongodb
                            items:
                              type: object
                              properties:
                                id:
                                  type: integer
                                  description: 行ID
                                  example: 18
                                zone_id:
                                  type: integer
                                  description: 可用区行ID
                                  example: 1
                                zone_display:
                                  type: string
                                  description: 可用区名称
                                  example: 仓科A区
                                dbtype:
                                  type: string
                                  description:  数据库标识
                                  example: "3"
                                dbtype_display:
                                  type: string
                                  description: 参数名称
                                  example: MySQL
                                flavorRef_id:
                                  type: integer
                                  description:  规格字典ID
                                  example: 55
                                flavorRef_display:
                                  type: string
                                  description:  规格名称
                                  example: 1核 2GB
                                flavorRef_iaas:
                                  type: string
                                  description:  对应iaas平台规格值
                                  example: ecs.n1.small
                                iaas_flavname:
                                  type: string
                                  description:  对应iaas平台规格名称，填空
                                  example: ''
                                iobyte:
                                  type: integer
                                  description:  iobyte（io读写mysql，mongodb类型需设置）
                                  example: 104857600
                                iops:
                                  type: integer
                                  description:  iops（io读写mysql，mongodb类型需设置）
                                  example: 1000
                                bwin:
                                  type: integer
                                  description:  bwin
                                  example: 0
                                bwout:
                                  type: integer
                                  description:  bwout
                                  example: 0
                          Redis:
                            type: array
                            description: mongodb
                            items:
                              type: object
                              properties:
                                id:
                                  type: integer
                                  description: 行ID
                                  example: 18
                                zone_id:
                                  type: integer
                                  description: 可用区行ID
                                  example: 1
                                zone_display:
                                  type: string
                                  description: 可用区名称
                                  example: 仓科A区
                                dbtype:
                                  type: string
                                  description:  数据库标识
                                  example: "3"
                                dbtype_display:
                                  type: string
                                  description: 参数名称
                                  example: MySQL
                                flavorRef_id:
                                  type: integer
                                  description:  规格字典ID
                                  example: 55
                                flavorRef_display:
                                  type: string
                                  description:  规格名称
                                  example: 1GB
                                flavorRef_iaas:
                                  type: string
                                  description:  对应iaas平台规格值
                                  example: ecs.n0.small
                                iaas_flavname:
                                  type: string
                                  description:  对应iaas平台规格名称，填空
                                  example: ''
                                iobyte:
                                  type: integer
                                  description:  iobyte
                                  example: 0
                                iops:
                                  type: integer
                                  description:  iops
                                  example: 0
                                bwin:
                                  type: integer
                                  description:  bwin (流量redis类型需设置）
                                  example: 100
                                bwout:
                                  type: integer
                                  description:  bwout (流量redis类型需设置）
                                  example: 100
  /platform/view/{zone_id}:
    get:
      tags: [可用区管理]
      summary:   install view
      description: 部署界面面板全局参数展示
      parameters:
        - name: zone_id
          in: path
          required: true
          description: 可用区行ID
          example: 1
          schema:
            type: integer
      responses:
        '200':
          description: 请求成功返回
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    description: 成功标志
                    example: True
                  data:
                    type: object
                    description: 数据返回
                    properties:
                      module:
                        type: array
                        description: 模式类型
                        items:
                          type: object
                          properties:
                            id:
                              type: integer
                              description: 行ID
                              example: 1
                            key:
                              type: string
                              description: 类型名称
                              example: 简单模式
                            value:
                              type: string
                              description: 参数值
                              example: '0'
                      nettype:
                        type: array
                        description: 网络类型
                        items:
                          type: object
                          properties:
                            id:
                              type: integer
                              description: 行ID
                              example: 78
                            key:
                              type: string
                              description: 类型名称
                              example: 专有网络
                            value:
                              type: string
                              description: 参数值
                              example: '1'
                      stortype:
                        type: array
                        description: 存储类型
                        items:
                          type: object
                          properties:
                            id:
                              type: integer
                              description: 行ID
                              example: 74
                            key:
                              type: string
                              description: 类型名称
                              example: SAS云盘
                            value:
                              type: string
                              description: 参数值
                              example: '11'
                      version:
                        type: object
                        description: 数据库版本类型
                        properties:
                          mongodb:
                            type: array
                            description: mongodb
                            items:
                              type: object
                              properties:
                                id:
                                  type: integer
                                  description: 行ID
                                  example: 15
                                key:
                                  type: string
                                  description: 类型名称
                                  example: MongoDB-3.2
                                value:
                                  type: string
                                  description: 参数值
                                  example: '3.2'
                                roletype:
                                  type: array
                                  description: 部署结构
                                  items:
                                    type: object
                                    properties:
                                      id:
                                        type: integer
                                        description: 行ID
                                        example: 24
                                      key:
                                        type: string
                                        description: 类型名称
                                        example: MongoDB-基础版
                                      value:
                                        type: string
                                        description: 参数值
                                        example: '3'
                          mysql:
                            type: array
                            description: mysql
                            items:
                              type: object
                              properties:
                                id:
                                  type: integer
                                  description: 行ID
                                  example: 11
                                key:
                                  type: string
                                  description: 类型名称
                                  example: MySQL-5.6
                                value:
                                  type: string
                                  description: 参数值
                                  example: '5.6'
                                roletype:
                                  type: array
                                  description: 部署结构
                                  items:
                                    type: object
                                    properties:
                                      id:
                                        type: integer
                                        description: 行ID
                                        example: 18
                                      key:
                                        type: string
                                        description: 类型名称
                                        example: MySQL-基础版
                                      value:
                                        type: string
                                        description: 参数值
                                        example: '3' 
                          redis:
                            type: array
                            description: redis
                            items:
                              type: object
                              properties:
                                id:
                                  type: integer
                                  description: 行ID
                                  example: 11
                                key:
                                  type: string
                                  description: 类型名称
                                  example: Redis-2.8
                                value:
                                  type: string
                                  description: 参数值
                                  example: '2.8'
                                roletype:
                                  type: array
                                  description: 部署结构
                                  items:
                                    type: object
                                    properties:
                                      id:
                                        type: integer
                                        description: 行ID
                                        example: 21
                                      key:
                                        type: string
                                        description: 类型名称
                                        example: Redis-基础版
                                      value:
                                        type: string
                                        description: 参数值
                                        example: '3'
                      zone:
                        type: array
                        description: 可用区
                        items:
                          type: object
                          properties:
                            id:
                              type: integer
                              description: 行ID
                              example: 1
                            key:
                              type: string
                              description: 类型名称
                              example: 仓科A区
                            value:
                              type: string
                              description: 参数值
                              example: 'a'  
  /flavorref/view/{zone_id}/dbtype/{dbtype}:
    get:
      tags: [可用区管理]
      summary:   flavor view
      description: 根据可用区和数据库类型展示规格信息
      parameters:
        - name: zone_id
          in: path
          required: true
          description: 可用区行ID
          example: 1
          schema:
            type: integer
        - name: dbtype
          in: path
          required: true
          description: 数据库类型
          example: "mysql"
          schema:
            type: string
      responses:
        '200':
          description: 请求成功返回
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    description: 成功标志
                    example: True
                  data:
                    type: array
                    description: 数据返回
                    items:
                      type: object
                      properties:
                        key:
                          type: string
                          description: 规格名称
                          example: 1核 1GB
                        value:
                          type: string
                          description: 规格值（对应dbaas平台）
                          example: db.n1.tiny
  /flavorref/view/{zone_id}:
    get:
      tags: [可用区管理]
      summary:   flavor view
      description: 查询可用区规格信息
      parameters:
        - name: zone_id
          in: path
          required: true
          description: 可用区行ID
          example: 1
          schema:
            type: integer
      responses:
        '200':
          description: 请求成功返回
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    description: 成功标志
                    example: True
                  data:
                    type: array
                    description: 数据返回
                    items:
                      type: object
                      properties:
                        id:
                          type: integer
                          description: 行ID
                          example: 1
                        zone_id:
                          type: integer
                          description: 可用区行ID
                          example: 1
                        zone_display:
                          type: string
                          description: 可用区名称
                          example: 仓科A区
                        dbtype:
                          type: string
                          description:  数据库标识
                          example: "3"
                        dbtype_display:
                          type: string
                          description: 参数名称
                          example: Mongodb
                        flavorRef_id:
                          type: integer
                          description:  规格字典ID
                          example: 55
                        flavorRef_display:
                          type: string
                          description:  规格名称
                          example: 1核 2GB
                        flavorRef_iaas:
                          type: string
                          description:  对应iaas平台规格值
                          example: ecs.n1.small
                        iaas_flavname:
                          type: string
                          description:  对应iaas平台规格名称，填空
                          example: ''
                        iobyte:
                          type: integer
                          description:  iobyte（io读写mysql，mongodb类型需设置）
                          example: 104857600
                        iops:
                          type: integer
                          description:  iops（io读写mysql，mongodb类型需设置）
                          example: 1000
                        bwin:
                          type: integer
                          description:  bwin
                          example: 0
                        bwout:
                          type: integer
                          description:  bwout
                          example: 0
  /flavorref/view:
    post:
      tags: [可用区管理]
      summary:  add flavorref
      description: 添加规格信息
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                dbtype:
                  type: string
                  example: '1'
                  description:  数据库类型参数值，对应字典表t_dict.dict_value
                flavorRef_id:
                  type: integer
                  example: 54
                  description: 规格参数值，对应字典表t_dict.id
                zone_id:
                  type: integer
                  example: 1
                  description: 可用区行号ID，对应可用区表t_zone.id
                flavorRef_iaas:
                  type: string
                  example: ecs.n1.small
                  description: 对应IAAS平台规格值
                iaas_flavname:
                  type: string
                  example: ''
                  description: 对应iaas平台规格名称，
                iobyte:
                  type: integer
                  description:  iobyte（io读写mysql，mongodb类型需设置）
                  example: 104857600
                iops:
                  type: integer
                  description:  iops（io读写mysql，mongodb类型需设置）
                  example: 1000
                bwin:
                  type: integer
                  description:  bwin (流量读写，redis设置)
                  example: 0
                bwout:
                  type: integer
                  description:  bwout (流量读写，redis设置)
                  example: 0
      responses:
        '200':
          description: 请求成功返回
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    description: 成功标志
                    example: True
  /flavorref/view/id/{id}:
    put:
      tags: [可用区管理]
      summary:  update flavorRef
      description: 修改规格信息
      parameters:
        - name: id
          in: path
          required: true
          description: 行号
          example: style
          schema:
            type: integer
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                dbtype:
                  type: string
                  example: '1'
                  description:  数据库类型参数值，对应字典表t_dict.dict_value
                flavorRef_id:
                  type: integer
                  example: 54
                  description: 规格参数值，对应字典表t_dict.id
                zone_id:
                  type: integer
                  example: 1
                  description: 可用区行号ID，对应可用区表t_zone.id
                flavorRef_iaas:
                  type: string
                  example: ecs.n1.small
                  description: 对应IAAS平台规格值
                iaas_flavname:
                  type: string
                  example: ''
                  description: 对应iaas平台规格名称，
                iobyte:
                  type: integer
                  description:  iobyte（io读写mysql，mongodb类型需设置）
                  example: 104857600
                iops:
                  type: integer
                  description:  iops（io读写mysql，mongodb类型需设置）
                  example: 1000
                bwin:
                  type: integer
                  description:  bwin (流量读写，redis设置)
                  example: 0
                bwout:
                  type: integer
                  description:  bwout (流量读写，redis设置)
                  example: 0

      responses:
        '200':
          description: 请求成功返回
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    description: 成功标志
                    example: True
    delete:
      tags: [可用区管理]
      summary:  delete flavorRef
      description: 删除规格信息
      parameters:
        - name: id
          in: path
          required: true
          description: 行号
          example: style
          schema:
            type: integer
      responses:
        '200':
          description: 请求成功返回
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    description: 成功标志
                    example: True
  /zv/v:
    get:
      tags: [可用区管理]
      summary:   all zone info
      description: 查询所有可用区信息
      responses:
        '200':
          description: 请求成功返回
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    description: 成功标志
                    example: True
                  data:
                    type: array
                    description: 数据返回
                    items:
                      type: object
                      properties:
                        id:
                          type: integer
                          description: 行ID
                          example: 1
                        iaas_code:
                          type: string
                          description: iaas平台编码
                          example: k
                        iaas_name:
                          type: string
                          description: iaas平台名称
                          example: kstack
                        rcode:
                          type: string
                          description:  大区编码
                          example: "ck"
                        rname:
                          type: string
                          description: 大区名称
                          example: 仓科
                        zone_code:
                          type: string
                          description: 可用区编码
                          example: a
                        zone_name:
                          type: string
                          description: 可用区名称
                          example: 仓科A区
                        zone_type:
                          type: string
                          description: 可用区类型
                          example: 1-虚机  2-物理机
                        url:
                          type: string
                          description: 访问可用区的url
                          example: iaas.cn-fuzhou-2.ops.com
                        user:
                          type: string
                          description: 用户名
                          example: dbaas_sys
                        password:
                          type: string
                          description: 密码
                          example: 4r8KfZW7W2g
    post:
      tags: [可用区管理]
      summary:  add zone
      description: 添加可用区信息
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                iaas_code:
                  type: string
                  description: iaas平台编码
                  example: k
                iaas_name:
                  type: string
                  description: iaas平台名称
                  example: kstack
                rcode:
                  type: string
                  description:  大区编码
                  example: "ck"
                rname:
                  type: string
                  description: 大区名称
                  example: 仓科
                zone_code:
                  type: string
                  description: 可用区编码
                  example: a
                zone_name:
                  type: string
                  description: 可用区名称
                  example: 仓科A区
                zone_type:
                  type: string
                  description: 可用区类型
                  example: 1-虚机  2-物理机
                url:
                  type: string
                  description: 访问可用区的url
                  example: iaas.cn-fuzhou-2.ops.com
                user:
                  type: string
                  description: 用户名
                  example: dbaas_sys
                password:
                  type: string
                  description: 密码
                  example: 4r8KfZW7W2g
      responses:
        '200':
          description: 请求成功返回
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    description: 成功标志
                    example: True
  /zv/v/{zone_id}:
    get:
      tags: [可用区管理]
      summary:   all zone info
      description: 查询某个可用区信息
      parameters:
        - name: zone_id
          in: path
          required: true
          description: 可用区行ID
          example: 1
          schema:
            type: integer
      responses:
        '200':
          description: 请求成功返回
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    description: 成功标志
                    example: True
                  data:
                    type: array
                    description: 数据返回
                    items:
                      type: object
                      properties:
                        id:
                          type: integer
                          description: 行ID
                          example: 1
                        iaas_code:
                          type: string
                          description: iaas平台编码
                          example: k
                        iaas_name:
                          type: string
                          description: iaas平台名称
                          example: kstack
                        rcode:
                          type: string
                          description:  大区编码
                          example: "ck"
                        rname:
                          type: string
                          description: 大区名称
                          example: 仓科
                        zone_code:
                          type: string
                          description: 可用区编码
                          example: a
                        zone_name:
                          type: string
                          description: 可用区名称
                          example: 仓科A区
                        zone_type:
                          type: string
                          description: 可用区类型
                          example: 1-虚机  2-物理机
                        url:
                          type: string
                          description: 访问可用区的url
                          example: iaas.cn-fuzhou-2.ops.com
                        user:
                          type: string
                          description: 用户名
                          example: dbaas_sys
                        password:
                          type: string
                          description: 密码
                          example: 4r8KfZW7W2g                                              
    put:
      tags: [可用区管理]
      summary:  update zone
      description: 修改可用区信息
      parameters:
        - name: zone_id
          in: path
          required: true
          description: 可用区行ID
          example: 1
          schema:
            type: integer
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                iaas_code:
                  type: string
                  description: iaas平台编码
                  example: k
                iaas_name:
                  type: string
                  description: iaas平台名称
                  example: kstack
                rcode:
                  type: string
                  description:  大区编码
                  example: "ck"
                rname:
                  type: string
                  description: 大区名称
                  example: 仓科
                zone_code:
                  type: string
                  description: 可用区编码
                  example: a
                zone_name:
                  type: string
                  description: 可用区名称
                  example: 仓科A区
                zone_type:
                  type: string
                  description: 可用区类型
                  example: 1-虚机  2-物理机
                url:
                  type: string
                  description: 访问可用区的url
                  example: iaas.cn-fuzhou-2.ops.com
                user:
                  type: string
                  description: 用户名
                  example: dbaas_sys
                password:
                  type: string
                  description: 密码
                  example: 4r8KfZW7W2g
      responses:
        '200':
          description: 请求成功返回
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    description: 成功标志
                    example: True
    delete:
      tags: [可用区管理]
      summary:  delete zone
      description: 删除可用区信息
      parameters:
        - name: zone_id
          in: path
          required: true
          description: 行号
          example: style
          schema:
            type: integer
      responses:
        '200':
          description: 请求成功返回
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    description: 成功标志
                    example: True
  /dt:
    get:
      tags: [可用区管理]
      summary:   all dict info
      description: 查询所有字典信息
      responses:
        '200':
          description: 请求成功返回
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    description: 成功标志
                    example: True
                  data:
                    type: array
                    description: 数据返回
                    items:
                      type: object
                      properties:
                        id:
                          type: integer
                          description: 行ID
                          example: 1
                        dict_key:
                          type: string
                          description: 字典名称
                          example: xtrabackup
                        dict_value:
                          type: string
                          description: 参数值
                          example: '2'
                        pname:
                          type: string
                          description:  字典类型
                          example: backup
                        dict_type:
                          type: string
                          description: 字典属性 pu- 公有，pr-私有
                          example:  pu
  /dt/vtype/{vtype}:
    get:
      tags: [可用区管理]
      summary:   pu or pr
      description: 根据属性查询所有字典信息
      parameters:
        - name: vtype
          in: path
          required: true
          description: 字典属性
          example: pu
          schema:
            type: string
      responses:
        '200':
          description: 请求成功返回
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    description: 成功标志
                    example: True
                  data:
                    type: array
                    description: 数据返回
                    items:
                      type: object
                      properties:
                        id:
                          type: integer
                          description: 行ID
                          example: 1
                        dict_key:
                          type: string
                          description: 字典名称
                          example: xtrabackup
                        dict_value:
                          type: string
                          description: 参数值
                          example: '2'
                        pname:
                          type: string
                          description:  字典类型
                          example: backup
                        dict_type:
                          type: string
                          description: 字典属性 pu- 公有，pr-私有
                          example:  pu
  /dt/name/{pname}:
    get:
      tags: [可用区管理]
      summary:   pu or pr
      description: 根据类型查询所有字典信息
      parameters:
        - name: pname
          in: path
          required: true
          description: 字典类型
          example: backup
          schema:
            type: string
      responses:
        '200':
          description: 请求成功返回
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    description: 成功标志
                    example: True
                  data:
                    type: array
                    description: 数据返回
                    items:
                      type: object
                      properties:
                        id:
                          type: integer
                          description: 行ID
                          example: 1
                        dict_key:
                          type: string
                          description: 字典名称
                          example: xtrabackup
                        dict_value:
                          type: string
                          description: 参数值
                          example: '2'
                        pname:
                          type: string
                          description:  字典类型
                          example: backup
                        dict_type:
                          type: string
                          description: 字典属性 pu- 公有，pr-私有
                          example:  pu
  /zonepu/z/{zone_id}:
    get:
      tags: [可用区管理]
      summary:   query public_dict 
      description: 根据可用区ID查询公共参数
      parameters:
        - name: zone_id
          in: path
          required: true
          description: 可用区行ID
          example: 1
          schema:
            type: integer
      responses:
        '200':
          description: 请求成功返回
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    description: 成功标志
                    example: True
                  data:
                    type: array
                    description: 数据返回
                    items:
                      type: object
                      properties:
                        id:
                          type: integer
                          description: 行ID
                          example: 1
                        dict_display:
                          type: string
                          description: 字典名称
                          example: xtrabackup
                        dict_value:
                          type: string
                          description: 参数值
                          example: '2'
                        dict_id:
                          type: integer
                          description:  字典ID
                          example: 1
                        zone_id:
                          type: integer
                          description: 可用区ID
                          example:  1
                        zone_display:
                          type: string
                          description: 可用区名称
                          example:  仓科A区
  /zonepu:
    post:
      tags: [可用区管理]
      summary:   add zone public_dict 
      description: 增加可用区公共参数
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                dict_id:
                  type: integer
                  description: 字典ID
                  example: 1
                zone_id:
                  type: integer
                  description: 可用区ID
                  example: 1
      responses:
        '200':
          description: 请求成功返回
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    description: 成功标志
                    example: True

  /zonepu/{id}:
    put:
      tags: [可用区管理]
      summary:  update zone public dict
      description: 修改可用区公共参数信息
      parameters:
        - name: id
          in: path
          required: true
          description: 可用区公共参数行ID
          example: 1
          schema:
            type: integer
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                dict_id:
                  type: integer
                  description: 字典ID
                  example: 1
                zone_id:
                  type: integer
                  description: 可用区ID
                  example: 1
      responses:
        '200':
          description: 请求成功返回
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    description: 成功标志
                    example: True
    delete:
      tags: [可用区管理]
      summary:  delete zone public
      description: 删除可用区公共参数信息
      parameters:
        - name: id
          in: path
          required: true
          description: 可用区公共参数行ID
          example: style
          schema:
            type: integer
      responses:
        '200':
          description: 请求成功返回
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    description: 成功标志
                    example: True
  /zonepr/z/{zone_id}:
    get:
      tags: [可用区管理]
      summary:   query private_dict 
      description: 根据可用区ID查询私有参数
      parameters:
        - name: zone_id
          in: path
          required: true
          description: 可用区行ID
          example: 1
          schema:
            type: integer
      responses:
        '200':
          description: 请求成功返回
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    description: 成功标志
                    example: True
                  data:
                    type: array
                    description: 数据返回
                    items:
                      type: object
                      properties:
                        id:
                          type: integer
                          description: 行ID
                          example: 1
                        dict_display:
                          type: string
                          description: 字典名称
                          example: ftp_ip
                        dict_value:
                          type: string
                          description: 参数值
                          example: 10.59.115.226
                        dict_id:
                          type: integer
                          description:  字典ID
                          example: 65
                        zone_id:
                          type: integer
                          description: 可用区ID
                          example:  1
                        zone_display:
                          type: string
                          description: 可用区名称
                          example:  仓科A区
  /zonepr:
    post:
      tags: [可用区管理]
      summary:   add zone private_dict 
      description: 增加可用区私有参数
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                dict_id:
                  type: integer
                  description: 字典ID
                  example: 1
                zone_id:
                  type: integer
                  description: 可用区ID
                  example: 1
                dict_value:
                  type: string
                  description: 参数值
                  example: '0'
      responses:
        '200':
          description: 请求成功返回
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    description: 成功标志
                    example: True

  /zonepr/{id}:
    put:
      tags: [可用区管理]
      summary:  update zone private dict
      description: 修改可用区私有参数信息
      parameters:
        - name: id
          in: path
          required: true
          description: 可用区私有参数行ID
          example: 1
          schema:
            type: integer
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                dict_id:
                  type: integer
                  description: 字典ID
                  example: 1
                zone_id:
                  type: integer
                  description: 可用区ID
                  example: 1
                dict_value:
                  type: string
                  description: 参数值
                  example: '0'
      responses:
        '200':
          description: 请求成功返回
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    description: 成功标志
                    example: True
    delete:
      tags: [可用区管理]
      summary:  delete zone private
      description: 可用区私有参数信息删除
      parameters:
        - name: id
          in: path
          required: true
          description: 可用区私有参数行ID
          example: style
          schema:
            type: integer
      responses:
        '200':
          description: 请求成功返回
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    description: 成功标志
                    example: True

  /dictconf/dbtype/{dbtype}:
    get:
      tags: [可用区管理]
      summary:   query database config
      description: 根据数据库类型查询数据库参数配置
      parameters:
        - name: dbtype
          in: path
          required: true
          description: 数据库类型
          example: mongodb
          schema:
            type: string
      responses:
        '200':
          description: 请求成功返回
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    description: 成功标志
                    example: True
                  data:
                    type: array
                    description: 数据返回
                    items:
                      type: object
                      properties:
                        id:
                          type: integer
                          description: 行ID
                          example: 1
                        dict_display:
                          type: string
                          description: 字典名称
                          example: 1核 2GB
                        dict_id:
                          type: integer
                          description:  字典ID
                          example: 55
                        dbtype:
                          type: string
                          description: 数据库类型编码
                          example:  '3'
                        dbtype_display:
                          type: string
                          description: 数据库名称
                          example:  MongoDB
                        conf_name:
                          type: string
                          description: 参数名称
                          example: wiredTigerCacheSizeGB
                        conf_value:
                          type: string
                          description: 参数值
                          example: '1'
                        conf_type:
                          type: integer
                          description: 参数值类型1-字符串，2-数值型
                          example: 2

  /dictconf:
    get:
      tags: [可用区管理]
      summary:   query  all database config
      description: 查询数据库参数配置
      responses:
        '200':
          description: 请求成功返回
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    description: 成功标志
                    example: True
                  data:
                    type: array
                    description: 数据返回
                    items:
                      type: object
                      properties:
                        id:
                          type: integer
                          description: 行ID
                          example: 1
                        dict_display:
                          type: string
                          description: 字典名称
                          example: 1核 2GB
                        dict_id:
                          type: integer
                          description:  字典ID
                          example: 55
                        dbtype:
                          type: string
                          description: 数据库类型编码
                          example:  '3'
                        dbtype_display:
                          type: string
                          description: 数据库名称
                          example:  MongoDB
                        conf_name:
                          type: string
                          description: 参数名称
                          example: wiredTigerCacheSizeGB
                        conf_value:
                          type: string
                          description: 参数值
                          example: '1'
                        conf_type:
                          type: integer
                          description: 参数值类型1-字符串，2-数值型
                          example: 2
                        descriptions:
                          type: string
                          description: 参数描述
                          example: ''
    post:
      tags: [可用区管理]
      summary:   add database config
      description: 增加数据库参数配置
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                dict_id:
                  type: integer
                  description:  字典ID
                  example: 55
                dbtype:
                  type: string
                  description: 数据库类型编码
                  example:  '3'
                conf_name:
                  type: string
                  description: 参数名称
                  example: wiredTigerCacheSizeGB
                conf_value:
                  type: string
                  description: 参数值
                  example: '1'
                conf_type:
                  type: integer
                  description: 参数值类型1-字符串，2-数值型
                  example: 2
                descriptions:
                  type: string
                  description: 参数描述
                  example: ''
      responses:
        '200':
          description: 请求成功返回
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    description: 成功标志
                    example: True

  /dictconf/{id}:
    put:
      tags: [可用区管理]
      summary:  update database config
      description: 修改数据库参数配置
      parameters:
        - name: id
          in: path
          required: true
          description: 参数配置表行ID
          example: 1
          schema:
            type: integer
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                dict_id:
                  type: integer
                  description:  字典ID
                  example: 55
                dbtype:
                  type: string
                  description: 数据库类型编码
                  example:  '3'
                conf_name:
                  type: string
                  description: 参数名称
                  example: wiredTigerCacheSizeGB
                conf_value:
                  type: string
                  description: 参数值
                  example: '1'
                conf_type:
                  type: integer
                  description: 参数值类型1-字符串，2-数值型
                  example: 2
                descriptions:
                  type: string
                  description: 参数描述
                  example: ''
      responses:
        '200':
          description: 请求成功返回
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    description: 成功标志
                    example: True
    delete:
      tags: [可用区管理]
      summary:  delete database config
      description: 删除数据库参数配置
      parameters:
        - name: id
          in: path
          required: true
          description: 参数配置表行ID
          example: style
          schema:
            type: integer
      responses:
        '200':
          description: 请求成功返回
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    description: 成功标志
                    example: True
